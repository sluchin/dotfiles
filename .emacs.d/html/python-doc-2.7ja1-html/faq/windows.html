

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Windows 上の Python FAQ &mdash; Python 2.7ja1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.7ja1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 2.7ja1 documentation 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="Python 2.7ja1 documentation" href="../index.html" />
    <link rel="up" title="Python よくある質問" href="index.html" />
    <link rel="next" title="グラフィックユーザインタフェース FAQ" href="gui.html" />
    <link rel="prev" title="拡張と埋め込み FAQ" href="extending.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/_jp.js"></script>
    
 

  </head>
  <body>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="gui.html" title="グラフィックユーザインタフェース FAQ"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="extending.html" title="拡張と埋め込み FAQ"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" accesskey="U">Python よくある質問</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">Windows 上の Python FAQ</a><ul>
<li><a class="reference internal" href="#python-windows">Python プログラムを Windows で動かすにはどうしますか？</a></li>
<li><a class="reference internal" href="#python">Python スクリプトを実行可能にするにはどうしますか？</a></li>
<li><a class="reference internal" href="#id1">Python の起動に時間がかかることがあるのはなぜですか？</a></li>
<li><a class="reference internal" href="#windows-freeze">Windows 用の Freeze はどこにありますか？</a></li>
<li><a class="reference internal" href="#pyd-dll"><tt class="docutils literal"><span class="pre">*.pyd</span></tt> ファイルは DLL と同じですか？</a></li>
<li><a class="reference internal" href="#id2">Python を Windows アプリケーションに埋め込むにはどうしたらいいですか？</a></li>
<li><a class="reference internal" href="#python-cgi">Python を CGI に使うにはどうしますか？</a></li>
<li><a class="reference internal" href="#id3">エディタが Python ソースにタブを勝手に挿入しないようにするにはどうしますか？</a></li>
<li><a class="reference internal" href="#id4">ブロックすることなく押鍵を検出するにはどうしますか？</a></li>
<li><a class="reference internal" href="#os-kill-windows">os.kill() を Windows で模倣するにはどうしますか？</a></li>
<li><a class="reference internal" href="#os-path-isdir-nt">os.path.isdir() が NT で共有されたディレクトリで失敗するのはなぜですか？</a></li>
<li><a class="reference internal" href="#cgi-py-cgi-nt-win95">cgi.py (その他の CGI プログラミング) が NT や win95 で動かないことがあります！</a></li>
<li><a class="reference internal" href="#os-popen-nt-pythonwin">os.popen() が NT 上の PythonWin で動かないのはなぜですか？</a></li>
<li><a class="reference internal" href="#os-popen-win32pipe-popen-win9x">os.popen()/win32pipe.popen() が Win9x で動かないのはなぜですか？</a></li>
<li><a class="reference internal" href="#pyrun-simplefile-windows-unix">PyRun_SimpleFile() は Windows 上ではクラッシュしますが、Unix 上ではしません。なぜですか？</a></li>
<li><a class="reference internal" href="#windows-95-98-tkinter">Windows 95/98 上で _tkinter のインポートに失敗します。なぜですか？</a></li>
<li><a class="reference internal" href="#windows">ダウンロードされたドキュメントを Windows 上で展開するにはどうしますか？</a></li>
<li><a class="reference internal" href="#cw3215mt-dll-cw3215-dll">cw3215mt.dll がありません(または cw3215.dll がありません)</a></li>
<li><a class="reference internal" href="#ctl3d32-version">インストーラからのCTL3D32 version に関する警告</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="extending.html"
                        title="前の章へ">拡張と埋め込み FAQ</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="gui.html"
                        title="次の章へ">グラフィックユーザインタフェース FAQ</a></p>
  <h3>このページ</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/faq/windows.txt"
           rel="nofollow">ソースコードを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="windows-python-faq">
<span id="windows-faq"></span><h1><a class="toc-backref" href="#id5">Windows 上の Python FAQ</a><a class="headerlink" href="#windows-python-faq" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#windows-python-faq" id="id5">Windows 上の Python FAQ</a><ul>
<li><a class="reference internal" href="#python-windows" id="id6">Python プログラムを Windows で動かすにはどうしますか？</a></li>
<li><a class="reference internal" href="#python" id="id7">Python スクリプトを実行可能にするにはどうしますか？</a></li>
<li><a class="reference internal" href="#id1" id="id8">Python の起動に時間がかかることがあるのはなぜですか？</a></li>
<li><a class="reference internal" href="#windows-freeze" id="id9">Windows 用の Freeze はどこにありますか？</a></li>
<li><a class="reference internal" href="#pyd-dll" id="id10"><tt class="docutils literal"><span class="pre">*.pyd</span></tt> ファイルは DLL と同じですか？</a></li>
<li><a class="reference internal" href="#id2" id="id11">Python を Windows アプリケーションに埋め込むにはどうしたらいいですか？</a></li>
<li><a class="reference internal" href="#python-cgi" id="id12">Python を CGI に使うにはどうしますか？</a></li>
<li><a class="reference internal" href="#id3" id="id13">エディタが Python ソースにタブを勝手に挿入しないようにするにはどうしますか？</a></li>
<li><a class="reference internal" href="#id4" id="id14">ブロックすることなく押鍵を検出するにはどうしますか？</a></li>
<li><a class="reference internal" href="#os-kill-windows" id="id15">os.kill() を Windows で模倣するにはどうしますか？</a></li>
<li><a class="reference internal" href="#os-path-isdir-nt" id="id16">os.path.isdir() が NT で共有されたディレクトリで失敗するのはなぜですか？</a></li>
<li><a class="reference internal" href="#cgi-py-cgi-nt-win95" id="id17">cgi.py (その他の CGI プログラミング) が NT や win95 で動かないことがあります！</a></li>
<li><a class="reference internal" href="#os-popen-nt-pythonwin" id="id18">os.popen() が NT 上の PythonWin で動かないのはなぜですか？</a></li>
<li><a class="reference internal" href="#os-popen-win32pipe-popen-win9x" id="id19">os.popen()/win32pipe.popen() が Win9x で動かないのはなぜですか？</a></li>
<li><a class="reference internal" href="#pyrun-simplefile-windows-unix" id="id20">PyRun_SimpleFile() は Windows 上ではクラッシュしますが、Unix 上ではしません。なぜですか？</a></li>
<li><a class="reference internal" href="#windows-95-98-tkinter" id="id21">Windows 95/98 上で _tkinter のインポートに失敗します。なぜですか？</a></li>
<li><a class="reference internal" href="#windows" id="id22">ダウンロードされたドキュメントを Windows 上で展開するにはどうしますか？</a></li>
<li><a class="reference internal" href="#cw3215mt-dll-cw3215-dll" id="id23">cw3215mt.dll がありません(または cw3215.dll がありません)</a></li>
<li><a class="reference internal" href="#ctl3d32-version" id="id24">インストーラからのCTL3D32 version に関する警告</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="python-windows">
<h2><a class="toc-backref" href="#id6">Python プログラムを Windows で動かすにはどうしますか？</a><a class="headerlink" href="#python-windows" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>これは単純な問題ではないかもしれません。あなたがすでに
Windows コマンドラインからプログラムを作動させることに慣れているなら、すぐに全て分かりますが、そうでなければ少し案内が必要です。Windows 95、98、NT、
ME、2000、XP の間にも差があり、混乱のもとになっています。</p>
<div class="sidebar">
<p class="first sidebar-title"><a class="reference external" href="http://www.showmedo.com/videos/series?name=pythonOzsvaldPyNewbieSeries"><img alt="Python Development on XP" src="../_images/python-video-icon.png" /></a></p>
<p class="sidebar-subtitle"><a class="reference external" href="http://www.showmedo.com/videos/series?name=pythonOzsvaldPyNewbieSeries">Python Development on XP</a></p>
<p class="last">このスクリーンキャストのシリーズは、あなたが Windows XP で Python を扱えるようにすることを目標としています。知識は 90 分に凝縮され、あなたが正しい Python ディストリビューションを、あなたが選んだ IDE でコーディングし、ユニットテストでデバッグをして堅実なコードを書いていけるようにします。</p>
</div>
<p>あなたがある種の統合開発環境を使っているのでない限り、結局は Windows コマンドを
&#8220;DOS ウィンドウ&#8221; や &#8220;コマンドプロンプトウィンドウ&#8221; と様々に呼ばれるものに
<em>タイプする</em> ことになります。通常、このようなウィンドウはスタートメニューから出すことができます。Windows 2000 では選ぶメニューは <em class="menuselection">Start ‣
Programs ‣ Accessories ‣ Command Prompt</em> です。そのようなウィンドウが開いたことは、通常このような Windows &#8220;コマンドプロンプト&#8221; が見られることからわかるでしょう:</p>
<div class="highlight-python"><pre>C:\&gt;</pre>
</div>
<p>この文字は異なっていたり、続きがあったりするので、コンピュータの設定や、あなたが最近何をしたかに依って、このようになっていることもあるでしょう:</p>
<div class="highlight-python"><pre>D:\Steve\Projects\Python&gt;</pre>
</div>
<p>このようなウィンドウさえ開けば、Python プログラムを動かす手順は順調に進みます。</p>
<p>前提として、Python スクリプトは、Python インタプリタという別のプログラムによって加工されなければなりません。インタプリタはスクリプトを読み込み、バイトコードにコンパイルし、そのバイトコードを実行してプログラムを動かします。では、インタプリタに Python を扱わせるにはどうするのでしょうか？</p>
<p>最初に、コマンドウィンドウが &#8220;python&#8221; という文字列をインタプリタを開始するための導入として認識していることを確かめる必要があります。コマンドウィンドウが開いたなら、コマンド <tt class="docutils literal"><span class="pre">python</span></tt> を入力してリターンキーを打ってみましょう。するとこのようなものが現れます:</p>
<div class="highlight-python"><pre>Python 2.2 (#28, Dec 21 2001, 12:21:22) [MSC 32 bit (Intel)] on win32
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt;</pre>
</div>
<p>インタプリタの&#8221;対話モード&#8221;が始まりました。これで Python の文や式を対話的に入力して、待っている間に実行や評価させることができます。これが Python の最強の機能のひとつです。いくつかの式を選んで入力し、結果を見て確かめてみましょう:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">print</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">)</span>
<span class="go">Hello</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s">&quot;Hello&quot;</span> <span class="o">*</span> <span class="mi">3</span>
<span class="go">HelloHelloHello</span>
</pre></div>
</div>
<p>多くの人が対話モードを便利で高度なプログラム可能計算機として使っています。対話式 Python セッションを終わらせたいなら、Ctrl キーを押しながら Z を入力し、
&#8220;Enter&#8221; キーを打って Windows コマンドプロンプトに戻ってください。</p>
<p>また、スタートメニューには <em class="menuselection">Start ‣ Programs ‣ Python 2.2
‣ Python (command line)</em> という項目があり、そこから新しいウィンドウで
<tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> というプロンプトが現れます。その場合は、Ctrl-Z の文字を入力するとウィンドウは消えます。Windows はウィンドウで &#8220;python&#8221; コマンドだけを実行していて、そのウィンドウはインタプリタを終了すると閉じられるのです。</p>
<p><tt class="docutils literal"><span class="pre">python</span></tt> コマンドで、インタプリタプロンプト <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> ではなく次のようなメッセージ:</p>
<div class="highlight-python"><pre>'python' is not recognized as an internal or external command,
operable program or batch file.</pre>
</div>
<div class="sidebar">
<p class="first sidebar-title"><a class="reference external" href="http://showmedo.com/videos/video?name=960000&amp;fromSeriesID=96"><img alt="Adding Python to DOS Path" src="../_images/python-video-icon.png" /></a></p>
<p class="sidebar-subtitle"><a class="reference external" href="http://showmedo.com/videos/video?name=960000&amp;fromSeriesID=96">Adding Python to DOS Path</a></p>
<p class="last">Python はデフォルトでは DOS パスに加えられていません。このスクリーンキャストでは、すべてのユーザーがコマンドラインから Python を実行できるようにして、 <cite>システムパス</cite> に適切な entry を加えられるようにします。</p>
</div>
<p>や:</p>
<div class="highlight-python"><pre>Bad command or filename</pre>
</div>
<p>が現れたなら、コンピュータが Python インタプリタの場所を認識しているか確かめなければなりません。そのためには、Windows がプログラムを探すディレクトリのリストである PATH という設定を変更しなければなりません。</p>
<p>コマンドウィンドウが始まるごとに Python がインストールされたディレクトリが
PATH 加えられるように設定するといいでしょう。あなたが Python をインストールしたのが結構最近なら、コマンド:</p>
<div class="highlight-python"><pre>dir C:\py*</pre>
</div>
<p>で、どこにインストールされているかわかるでしょう。通常の場所は
<tt class="docutils literal"><span class="pre">C:\Python23</span></tt> のようになっています。そうでなければ、ディスク全体を検索することになるでしょう ... <em class="menuselection">Tools ‣ Find</em> を使うか
<em class="guilabel">Search</em> ボタンを押して &#8220;python.exe&#8221; を探してください。
Python が <tt class="docutils literal"><span class="pre">C:\Python23</span></tt> ディレクトリ (執筆時点でのデフォルト) にインストールされていたとしたら、次のコマンドを入力すれば上と同じようなインタプリタが開始されることがわかるでしょう (もちろん、終了に
&#8220;CTRL-Z&#8221; と &#8220;Enter&#8221; が必要です):</p>
<div class="highlight-python"><pre>c:\Python23\python</pre>
</div>
<p>一旦ディレクトリを変更したら、コンピュータが行うスタートアップルーチンに加える必要があります。古いバージョンの Windows では、一番簡単な方法は
<tt class="docutils literal"><span class="pre">C:\AUTOEXEC.BAT</span></tt> ファイルを編集することです。<tt class="docutils literal"><span class="pre">AUTOEXEC.BAT</span></tt> に以下の行を追加しましょう:</p>
<div class="highlight-python"><pre>PATH C:\Python23;%PATH%</pre>
</div>
<p>Windows NT、2000、(おそらく) XP では、このような文字列:</p>
<div class="highlight-python"><pre>;C:\Python23</pre>
</div>
<p>を &#8220;マイコンピュータ&#8221; のプロパティウィンドウの &#8220;詳細&#8221; タブにある、
PATH 環境変数の現在の設定に加えましょう。なお、十分な権限があれば、現在のユーザに設定するかシステムに設定するかを選べます。すべてのユーザーが
Python をコンピュータで実行したいのであれば後者を選ぶのがいいです。</p>
<p>この中に自信のない操作があれば、助けを求めてください！　ここでは、新しい設定が効いたことを絶対確実にするために、システムを再起動しましょう。
Windows NT、XP、2000 では、おそらく再起動の必要はないでしょう。それ以前のバージョンでも、<tt class="docutils literal"><span class="pre">AUTOEXEC.BAT</span></tt> の代わりに
<tt class="docutils literal"><span class="pre">C:\WINDOWS\COMMAND\CMDINIT.BAT</span></tt> を編集すれば再起動しなくて済みます。</p>
<p>これで新しいコマンドウィンドウが開き、<tt class="docutils literal"><span class="pre">C:\&gt;</span></tt> (等) のプロンプトに
<tt class="docutils literal"><span class="pre">python</span></tt> を入力すれば、Python インタプリタが対話式コマンドを受け付けることを示す <tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> が現れるでしょう。</p>
<p>それでは、<tt class="docutils literal"><span class="pre">pytest.py</span></tt> というプログラムが <tt class="docutils literal"><span class="pre">C:\Steve\Projects\Python</span></tt>
ディレクトリにあったとしましょう。このプログラムを実行するためのセッションはこのようになるでしょう:</p>
<div class="highlight-python"><pre>C:\&gt; cd \Steve\Projects\Python
C:\Steve\Projects\Python&gt; python pytest.py</pre>
</div>
<p>インタプリタを開始するためのコマンドにファイル名を加えたので、インタプリタは開始時にその名前の Python スクリプトを読み込み、コンパイルし、実行し、終了し、それから再び <tt class="docutils literal"><span class="pre">C:\&gt;</span></tt> プロンプトが現れます。カレントディレクトリを変更したくないなら、このように入力しても良いです:</p>
<div class="highlight-python"><pre>C:\&gt; python \Steve\Projects\Python\pytest.py</pre>
</div>
<p>NT、2000、XP では、インストール過程ですでにコマンド <tt class="docutils literal"><span class="pre">pytest.py</span></tt> (または、カレントディレクトリになければ <tt class="docutils literal"><span class="pre">C:\Steve\Projects\Python\pytest.py</span></tt>) が
&#8221;.py&#8221; 拡張子を認識してその名前のファイルで Python を実行するように準備してあるかもしれません。この機能を使うと便利ですが、Windows の <em>いくつかの</em>
バージョンでは、この形式がインタプリタを明示的に使うのと正確には同じにならないというバグがありますので、ご注意ください。</p>
<p>憶えておくべき重要なポイントは:</p>
<ol class="arabic">
<li><p class="first">Python をスタートメニューから開始する、または PATH を正しく設定して
Windows が Python インタプリタを見つけられるようにします:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">python</span>
</pre></div>
</div>
<p>で Python インタプリタから &#8216;&gt;&gt;&gt;&#8217; プロンプトが与えられます。もちろん、
CTRL-Z と ENTER でインタプリタが終了します(そして、スタートメニューからそのウィンドウを開始したのなら、そのウィンドウは消えます)。</p>
</li>
<li><p class="first">それができたら、このコマンドでプログラムを実行してください:</p>
<div class="highlight-python"><pre>python {program-file}</pre>
</div>
</li>
<li><p class="first">使うべきコマンドを知れば、特定の作業ディレクトリを指定して、どのスクリプト上でも Python インタプリタを実行する Windows ショートカットを構成できます。複雑なことがしたいなら:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">python</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>を見てください。</p>
</li>
<li><p class="first">対話モード (<tt class="docutils literal"><span class="pre">&gt;&gt;&gt;</span></tt> プロンプトが現れるところ) は、単一の文や式が思ったとおりに動くか確かめたり、実験的にコードを開発するときに使うと最高です。</p>
</li>
</ol>
</div>
<div class="section" id="python">
<h2><a class="toc-backref" href="#id7">Python スクリプトを実行可能にするにはどうしますか？</a><a class="headerlink" href="#python" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Windows 2000 では、標準の Python インストーラはすでに .py 拡張子をあるファイル型 (Python.File) に関連付け、そのファイル型にインタプリタを実行するオープンコマンド (<tt class="docutils literal"><span class="pre">D:\Program</span> <span class="pre">Files\Python\python.exe</span> <span class="pre">&quot;%1&quot;</span> <span class="pre">%*</span></tt>) を与えます。コマンドプロンプトから &#8216;foo.py&#8217; としてスクリプトを実行可能にするにはこれで十分です。スクリプトを拡張子なしで &#8216;foo&#8217; とだけタイプして実行したいのなら、PATHEXT 環境変数に .py を加えてください。</p>
<p>Windows NT では、インストーラによって行われる上記のような段階により、スクリプトを &#8216;foo.py&#8217; で実行できるようになりますが、長年のバグにより、
NT コマンドプロセッサで入力や出力のリダイレクトをすることは、この方法ではできません。これがしばしば重要になります。</p>
<p>Python スクリプトを WinNT で実行できるようにするおまじないは、ファイルに .cmd 拡張子をつけ、最初の行に以下の文を加えることです:</p>
<div class="highlight-python"><pre>@setlocal enableextensions &amp; python -x %~f0 %* &amp; goto :EOF</pre>
</div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id8">Python の起動に時間がかかることがあるのはなぜですか？</a><a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>通常 Python は Windows でとても早く起動しますが、ときどき Python が急にスタートアップに時間がかかるようになったというバグレポートがあります。更に複雑なことに、Python は同様に設定された他の Windows システムではきちんと動くのです。</p>
<p>この問題はそのマシンのウイルス対策ソフトウェアの設定ミスによって起こされることがあります。ウイルススキャナの中には、ファイルシステムからの全ての読み込みを監視するように設定した場合に、二桁のスタートアップオーバーヘッドを引き起すことが知られているものがあります。あなたのシステムのウイルススキャンソフトウェアの設定を確かめて、本当に同様に設定されていることを確実にしてください。</p>
</div>
<div class="section" id="windows-freeze">
<h2><a class="toc-backref" href="#id9">Windows 用の Freeze はどこにありますか？</a><a class="headerlink" href="#windows-freeze" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>&#8220;Freeze&#8221; は Python プログラムをひとつのスタンドアロンな実行可能なファイルにまとめて送れるようにするプログラムです。これはコンパイラ <em>ではありません</em>。プログラムの実行が速くなるわけでも、配布が簡単になるわけでもありません、少なくとも OS や CPU が同じならば。</p>
<p>Windows で freeze を使用できますが、ソースツリーをダウンロードする必要があります (<a class="reference external" href="http://www.python.org/download/source">http://www.python.org/download/source</a> を参照してください)。
freeze プログラムはソースツリーの <tt class="docutils literal"><span class="pre">Tools\freeze</span></tt> サブディレクトリにあります。</p>
<p>Microsoft VC++ コンパイラが必要で、Python をビルドすることも必要になるでしょう。要求されるプロジェクトファイルは PCbuild ディレクトリにあります。</p>
</div>
<div class="section" id="pyd-dll">
<h2><a class="toc-backref" href="#id10"><tt class="docutils literal"><span class="pre">*.pyd</span></tt> ファイルは DLL と同じですか？</a><a class="headerlink" href="#pyd-dll" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>はい、.pyd ファイルは dll と同じようなものですが、少し違いがあります。
<tt class="docutils literal"><span class="pre">foo.pyd</span></tt> という名前の DLL があったとしたら、それには関数 <tt class="docutils literal"><span class="pre">initfoo()</span></tt> が含まれていなければなりません。そうすれば Python で &#8220;import foo&#8221; を書けて、
Python は foo.pyd (や foo.py、foo.pyc) を探して、あれば、<tt class="docutils literal"><span class="pre">initfoo()</span></tt> を呼び出して初期化しようとします。Windows が DLL の存在を必要とするのと違い、
.exe ファイルを foo.lib にリンクするわけではありません。</p>
<p>なお、foo.pyd を検索するパスは PYTHONPATH であり、Windows が foo.dll を検索するパスと同じではありません。また、プログラムを dll にリンクしたときはプログラムの実行に dll が必要ですが、foo.pyd は実行には必要はありません。もちろん、<tt class="docutils literal"><span class="pre">import</span> <span class="pre">foo</span></tt> したいなら foo.pyd は 必要です。DLL では、リンクはソースコード内で <tt class="docutils literal"><span class="pre">__declspec(dllexport)</span></tt> によって宣言されます。.pyd では、リンクは使える関数のリストで定義されます。</p>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id11">Python を Windows アプリケーションに埋め込むにはどうしたらいいですか？</a><a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python インタプリタを Windows app に埋め込む方法は、次のように要約できます:</p>
<ol class="arabic">
<li><p class="first">Python を .exe ファイルディレクトリに組み込 _まないでください_ 。Windows
では、Python は (それ自体 DLL である) モジュールをインポートして扱う
DLL でなくてはなりません (ドキュメント化されていない重大な事実の一つ目です)。組み込む代わりに、<tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></tt> にリンクしてください。通常は <tt class="docutils literal"><span class="pre">C:\Windows\System</span></tt> にインストールされています。<em>NN</em> は Python のバージョンで、Python 2.3 なら &#8220;23&#8221; のようになります。</p>
<p>Python には、静的に、または動的にリンクできます。静的なリンクは、
<tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></tt> に対してリンクするもので、動的なリンクは
<tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></tt> に対してリンクするものです。動的なリンクの欠点は、
<tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></tt> がシステムに存在しないとアプリケーションが起動しないことです。(一般的な注意:
<tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></tt> は <tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></tt> に対するいわゆる
&#8220;インポートライブラリ&#8221; です。これは単にリンカに対するシンボルを定義します。)</p>
<p>動的なリンクは、リンクの選択を大いに単純化します。全ては実行時に行われます。コードは Windows の
<tt class="docutils literal"><span class="pre">LoadLibraryEx()</span></tt> ルーチンで <tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></tt> をロードしなければなりません。コードはまた、Windows の <tt class="docutils literal"><span class="pre">GetProcAddress()</span></tt>
ルーチンで得られるポインタで、<tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.dll</span></tt> (すなわち、Python の
C API)のルーチンとデータへアクセスしていなければなりません。マクロによって、このポインタを Python の C API のルーチンを呼び出す任意の C コードに通して使えます。</p>
<p>Borland note: まず <tt class="file docutils literal"><span class="pre">python</span><em><span class="pre">NN</span></em><span class="pre">.lib</span></tt> を Coff2Omf.exe で OMF
フォーマットに変換してください。</p>
</li>
<li><p class="first">SWIG を使えば、app のデータとメソッドを Python で使えるようにする Python
&#8220;拡張モジュール&#8221;を簡単に作れます。SWIG は雑用を殆どやってくれるでしょう。結果として、.exe ファイル <em>の中に</em> リンクする C コードができます(！)。
DLL を作 _らなくてもよく_ 、リンクも簡潔になります。</p>
</li>
<li><p class="first">SWIG は拡張の名前に依る名前の init 関数 (C 関数) を作ります。例えば、モジュールの名前が leo なら、init 関数の名前は initleo() になります。
SWIG shadow クラスを使ったほうがよく、そうすると init 関数の名前は
initleoc() になります。これは shadow クラスが使うほとんど隠れた helper
クラスを初期化します。</p>
<p>ステップ 2 の C コードを .exe ファイルにリンクできるのは、初期化関数の呼び出しと Python へのモジュールのインポートが同等だからです！
(ドキュメント化されていない重大な事実の二つ目です)</p>
</li>
<li><p class="first">要するに、以下のコードを使って Python インタプリタを拡張モジュール込みで初期化することができます。</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &quot;python.h&quot;</span>
<span class="p">...</span>
<span class="n">Py_Initialize</span><span class="p">();</span>  <span class="c1">// Initialize Python.</span>
<span class="n">initmyAppc</span><span class="p">();</span>  <span class="c1">// Initialize (import) the helper class.</span>
<span class="n">PyRun_SimpleString</span><span class="p">(</span><span class="s">&quot;import myApp&quot;</span><span class="p">)</span> <span class="p">;</span>  <span class="c1">// Import the shadow class.</span>
</pre></div>
</div>
</li>
<li><p class="first">Python の C API には、pythonNN.dll をビルドするのに使われたコンパイラ
MSVC 以外のコンパイラを使うと現れる二つの問題があります。</p>
<p>問題 1: コンパイラによって struct FILE に対する概念が異なるため、FILE *
引数を取るいわゆる &#8220;超高水準&#8221; 関数は、多コンパイラ環境で働きません。実装の観点から、これらは超 _低_ 水準関数になっています。</p>
<p>問題 2: SWIG は void 関数へのラッパを生成するときに以下のコードを生成します:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">Py_INCREF</span><span class="p">(</span><span class="n">Py_None</span><span class="p">);</span>
<span class="n">_resultobj</span> <span class="o">=</span> <span class="n">Py_None</span><span class="p">;</span>
<span class="k">return</span> <span class="n">_resultobj</span><span class="p">;</span>
</pre></div>
</div>
<p>ああ、Py_none は pythonNN.dll 内の _Py_NoneStruct という複雑なデータ構造に展開するマクロです。また、このコードは他コンパイラ環境では失敗します。このコードを次のように置き換えてください:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="k">return</span> <span class="n">Py_BuildValue</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
</pre></div>
</div>
<p>これで、SWIG をまだ仕事に使えない (私は SWIG の完全な初心者です) 私でも、
SWIG の <tt class="docutils literal"><span class="pre">%typemap</span></tt> コマンドを使って自動的に変更できるようになります。</p>
</li>
<li><p class="first">Python シェルスクリプトを使って Windows app 内から Python
インタプリタウィンドウを掲示するのはいい方法ではありません。そのように表示されるウィンドウは app のウィンドウシステムとは関係ありません。むしろ
&#8220;ネイティブな&#8221; インタプリタウィンドウを (wxPythonWindow を使ったりして)
作るべきです。そのウィンドウを Python インタプリタにつなぐのは簡単です。
Python の i/o は読み書きをサポートする _どんな_ オブジェクトにもリダイレクトできるので、read() と write() メソッドを含む (拡張モジュールで定義された) Python オブジェクトさえあればいいのです。</p>
</li>
</ol>
</div>
<div class="section" id="python-cgi">
<h2><a class="toc-backref" href="#id12">Python を CGI に使うにはどうしますか？</a><a class="headerlink" href="#python-cgi" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Microsoft IIS server と Win95 MS Personal Web Server では、
Python を他のどんなスクリプトエンジンとも同じように設定します。</p>
<p>regedt32 を起動し:</p>
<div class="highlight-python"><pre>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\ScriptMap</pre>
</div>
<p>に移動し、以下の行を入力してください。(システムによって変わることがあります):</p>
<div class="highlight-python"><pre>.py :REG_SZ: c:\&lt;path to python&gt;\python.exe -u %s %s</pre>
</div>
<p>この一行によって、スクリプトを <tt class="docutils literal"><span class="pre">http://yourserver/scripts/yourscript.py</span></tt> のように簡単な参照で呼び出せるようになります。ここで &#8220;scripts&#8221; は
(通常はデフォルトの) &#8220;executable&#8221; ディレクトリです。<a class="reference internal" href="../using/cmdline.html#cmdoption-u"><em class="xref std std-option">-u</em></a> フラグはバッファリングを無効にしたバイナリモードを stdin に使うことを指定するフラグで、バイナリデータを扱うときに必要です。</p>
<p>さらに、この状況で使われるファイル拡張子には &#8221;.py&#8221; を使うのを避けることを勧めます (サポートモジュールに <tt class="docutils literal"><span class="pre">*.py</span></tt> を、&#8221;メインプログラム&#8221; スクリプトに
<tt class="docutils literal"><span class="pre">*.cgi</span></tt> や <tt class="docutils literal"><span class="pre">*.cgp</span></tt> を残しておきたいでしょう)。</p>
<p>Python を CGI 加工に使うために Internet Information Services 5 を設定するには、以下のリンクを参照してください:</p>
<blockquote>
<div><a class="reference external" href="http://www.e-coli.net/pyiis_server.html">http://www.e-coli.net/pyiis_server.html</a> (for Win2k Server)
<a class="reference external" href="http://www.e-coli.net/pyiis.html">http://www.e-coli.net/pyiis.html</a> (for Win2k pro)</div></blockquote>
<p>Apache の設定はもっと単純です。Apache の設定ファイル <tt class="docutils literal"><span class="pre">httpd.conf</span></tt> で、ファイルの終わりに以下の行を加えてください:</p>
<div class="highlight-python"><pre>ScriptInterpreterSource Registry</pre>
</div>
<p>そして、Python CGI スクリプトに拡張子 .py をつけて、それらを
cgi-bin ディレクトリに置いてください。</p>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id13">エディタが Python ソースにタブを勝手に挿入しないようにするにはどうしますか？</a><a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>この FAQ ではタブを使うことを勧めません。Python スタイルガイド <span class="target" id="index-0"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0008"><strong>PEP 8</strong></a> では、配布される Python コードにはスペース 4 つを使うことを推奨しています。これは Emacs の python-mode のデフォルトでも同じです。</p>
<p>いかなるエディタでも、タブとスペースを混ぜるのは良くないです。
MSVC も全く同じ立場であり、スペースを使うようにする設定が簡単にできます。
<em class="menuselection">Tools ‣ Options ‣ Tabs</em> を選択し、ファイルタイプの
&#8220;デフォルト&#8221; の &#8220;タブ幅&#8221; と &#8220;インデント幅&#8221; に 4 を設定して、
&#8220;スペースを挿入する&#8221; のラジオボタンを選択してください。</p>
<p>タブとスペースが混ざっていることで先頭の空白に問題が出ている可能性があるなら、
Python を <a class="reference internal" href="../using/cmdline.html#cmdoption-t"><em class="xref std std-option">-t</em></a> スイッチをつけて起動するか、
<tt class="docutils literal"><span class="pre">Tools/Scripts/tabnanny.py</span></tt> を起動してディレクトリツリーをバッチモードで確認してください。</p>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id14">ブロックすることなく押鍵を検出するにはどうしますか？</a><a class="headerlink" href="#id4" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>msvcrt モジュールを使ってください。これは標準の Windows 専用拡張モジュールです。これはキーボードが打たれているかを調べる関数 <tt class="docutils literal"><span class="pre">kbhit()</span></tt> と、反響することなく一文字を得る <tt class="docutils literal"><span class="pre">getch()</span></tt> を定義します。</p>
</div>
<div class="section" id="os-kill-windows">
<h2><a class="toc-backref" href="#id15">os.kill() を Windows で模倣するにはどうしますか？</a><a class="headerlink" href="#os-kill-windows" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python 2.7 および 3.2 以前では、プロセスを終了するために、<a class="reference internal" href="../library/ctypes.html#module-ctypes" title="ctypes: A foreign function library for Python."><tt class="xref py py-mod docutils literal"><span class="pre">ctypes</span></tt></a> が使えます:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">ctypes</span>

<span class="k">def</span> <span class="nf">kill</span><span class="p">(</span><span class="n">pid</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;kill function for Win32&quot;&quot;&quot;</span>
    <span class="n">kernel32</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">kernel32</span>
    <span class="n">handle</span> <span class="o">=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">OpenProcess</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pid</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">0</span> <span class="o">!=</span> <span class="n">kernel32</span><span class="o">.</span><span class="n">TerminateProcess</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>2.7 および 3.2 では、上の関数と同様な <a class="reference internal" href="../library/os.html#os.kill" title="os.kill"><tt class="xref py py-func docutils literal"><span class="pre">os.kill()</span></tt></a> が実装されていて、追加の機能として、CTRL+C や CTRL+BREAK をそれらのシグナルを扱うように設計されたコンソールのサブプロセスに送ることができます。</p>
</div>
<div class="section" id="os-path-isdir-nt">
<h2><a class="toc-backref" href="#id16">os.path.isdir() が NT で共有されたディレクトリで失敗するのはなぜですか？</a><a class="headerlink" href="#os-path-isdir-nt" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>共有されたドライブの最後にいつも &#8220;\&#8221; を加えることで、解決が見えます:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span> <span class="s">&#39;</span><span class="se">\\\\</span><span class="s">rorschach</span><span class="se">\\</span><span class="s">public&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span> <span class="s">&#39;</span><span class="se">\\\\</span><span class="s">rorschach</span><span class="se">\\</span><span class="s">public</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>共有店をドライブ文字と同じようなものと考えるとわかりやすいです。例:</p>
<div class="highlight-python"><pre>k: is not a directory
k:\ is a directory
k:\media is a directory
k:\media\ is not a directory</pre>
</div>
<p>&#8220;k:&#8221; を &#8220;\conkyfoo&#8221; に置き換えても同じことが言えます:</p>
<div class="highlight-python"><pre>\\conky\foo  is not a directory
\\conky\foo\ is a directory
\\conky\foo\media is a directory
\\conky\foo\media\ is not a directory</pre>
</div>
</div>
<div class="section" id="cgi-py-cgi-nt-win95">
<h2><a class="toc-backref" href="#id17">cgi.py (その他の CGI プログラミング) が NT や win95 で動かないことがあります！</a><a class="headerlink" href="#cgi-py-cgi-nt-win95" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>最新の python.exe であること、Python の GUI バージョンではなく
python.exe を使っていること、それからサーバが CGI 拡張に:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="s">&quot;...\python.exe -u ...&quot;</span>
</pre></div>
</div>
<p>を実行するように設定してあることを確認してください。<a class="reference internal" href="../using/cmdline.html#cmdoption-u"><em class="xref std std-option">-u</em></a> (unbuffered)
オプションは NT や Win95 でインタプリタが標準入出力で改行を変換することを防ぎます。これがないとリクエストの post/multipart は誤った長さを持つと見なされ、バイナリ (例えば GIF) の応答がでっち上げられる(そして壊れた画像、
PDF ファイル、その他のバイナリのダウンロード失敗につながる)でしょう。</p>
</div>
<div class="section" id="os-popen-nt-pythonwin">
<h2><a class="toc-backref" href="#id18">os.popen() が NT 上の PythonWin で動かないのはなぜですか？</a><a class="headerlink" href="#os-popen-nt-pythonwin" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>os.popen() が PythonWin の内部から動かないのは、Microsoft の C Runtime Library
(CRT) のバグによるものです。CRT はプロセスに Win32 コンソールが結び付けられていると決めてかかります。</p>
<p>その代わりに、Win32 コンソールが結び付けられているかに依らない win32pipe
モジュールの popen() を使うべきです。</p>
<p>例:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">win32pipe</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">win32pipe</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="s">&#39;dir /c c:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="os-popen-win32pipe-popen-win9x">
<h2><a class="toc-backref" href="#id19">os.popen()/win32pipe.popen() が Win9x で動かないのはなぜですか？</a><a class="headerlink" href="#os-popen-win32pipe-popen-win9x" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Win9x にはバグがあって、os.popen/win32pipe.popen* が働きません。嬉しいことに、この問題に対処する方法があります。Microsoft Knowledge Base のこの記事を調べてください: Q150956。この knowledge base へのリンクはここで見つかります:
<a class="reference external" href="http://support.microsoft.com/">http://support.microsoft.com/</a>。</p>
</div>
<div class="section" id="pyrun-simplefile-windows-unix">
<h2><a class="toc-backref" href="#id20">PyRun_SimpleFile() は Windows 上ではクラッシュしますが、Unix 上ではしません。なぜですか？</a><a class="headerlink" href="#pyrun-simplefile-windows-unix" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>コンパイラのベンダ、バージョン、(もしかすると) オプションに関しても微妙です。埋め込みシステムの FILE* 構造体が Python インタプリタの想定と異なると、うまく行きません。</p>
<p>Python 1.5.* DLLs (<tt class="docutils literal"><span class="pre">python15.dll</span></tt>) は全て MS VC++ 5.0 にてマルチスレッディング DLL オプション (<tt class="docutils literal"><span class="pre">/MD</span></tt>) をつけてコンパイルされています。</p>
<p>コンパイラやフラグを変更できないなら、<tt class="xref c c-func docutils literal"><span class="pre">Py_RunSimpleString()</span></tt> を使ってみてください。これで任意のファイルを起動するための技は、<tt class="xref py py-func docutils literal"><span class="pre">exec()</span></tt> や
<a class="reference internal" href="../library/functions.html#open" title="open"><tt class="xref py py-func docutils literal"><span class="pre">open()</span></tt></a> をファイル名を引数として呼ぶことです。</p>
<p>また、Debug と Release 版は継ぎ合わせられません。Debug マルチスレッド DLL を使いたいなら、そのモジュールは <tt class="docutils literal"><span class="pre">_d</span></tt> がファイル名に加えられ <em>ていなくてはなりません</em>。</p>
</div>
<div class="section" id="windows-95-98-tkinter">
<h2><a class="toc-backref" href="#id21">Windows 95/98 上で _tkinter のインポートに失敗します。なぜですか？</a><a class="headerlink" href="#windows-95-98-tkinter" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>たまに、_tkinter のインポートが Windows 95 や 98 で失敗し、その時に以下のようなメッセージを訴えます:</p>
<div class="highlight-python"><pre>ImportError: DLL load failed: One of the library files needed
to run this application cannot be found.</pre>
</div>
<p>このとき Tcl/Tk がインストールされていないのかもしれませんが、Tcl/Tk がインストールされていて、Wish アプリケーションが正しく動いているなら、インストーラが autoexec.bat を適切に編集していないという問題かもしれません。インストーラは PATH 環境変数に Tcl/Tk &#8216;bin&#8217; サブディレクトリを含めるように変える文を追加しようとしますが、この編集が機能していないことがあります。通常、このファイルをノートパッドで開くことで、問題が何か解ります。</p>
<p>(David Szafranski による追加のヒント: ここで長いファイル名を使ってはいけません。例えば、<tt class="docutils literal"><span class="pre">C:\Program</span> <span class="pre">Files\Tcl\bin</span></tt> の代わりに
<tt class="docutils literal"><span class="pre">C:\PROGRA~1\Tcl\bin</span></tt> を使ってください。)</p>
</div>
<div class="section" id="windows">
<h2><a class="toc-backref" href="#id22">ダウンロードされたドキュメントを Windows 上で展開するにはどうしますか？</a><a class="headerlink" href="#windows" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>たまに、web ブラウザで Windows マシンにドキュメントパッケージをダウンロードするとき、その保存されたファイルの拡張子が .EXE になっていることがあります。これは間違いです。本来の拡張子は .TGZ です。</p>
<p>単純に、ダウンロードしたファイルを名付け直して拡張子を .TGZ にしてください。そうすれば WinZip で扱えます。(手元の WinZip でできなかったら、
<a class="reference external" href="http://www.winzip.com">http://www.winzip.com</a> から新しいのをもらいましょう)</p>
</div>
<div class="section" id="cw3215mt-dll-cw3215-dll">
<h2><a class="toc-backref" href="#id23">cw3215mt.dll がありません(または cw3215.dll がありません)</a><a class="headerlink" href="#cw3215mt-dll-cw3215-dll" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>たまに、Tkinter を Windows で使っているとき、 cw3215mt.dll や cw3215.dll が見つからないというエラーが出ます。</p>
<p>原因: パス (おそらく <tt class="docutils literal"><span class="pre">C:\Windows</span></tt>) にある Tcl/Tk DLL が cygwin でビルドされた古いものです。標準の Tcl/Tk インストール (Python 1.5.2 に付属しています) による
Tcl/Tk を使わなければなりません。</p>
</div>
<div class="section" id="ctl3d32-version">
<h2><a class="toc-backref" href="#id24">インストーラからのCTL3D32 version に関する警告</a><a class="headerlink" href="#ctl3d32-version" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Python インストーラはこのような警告をします:</p>
<div class="highlight-python"><pre>This version uses CTL3D32.DLL which is not the correct version.
This version is used for windows NT applications only.</pre>
</div>
<p>Tim Peters いわく:</p>
<blockquote>
<div>これは DLL の、そして悪名高きソースの問題です。このメッセージが伝えるものはこうです: この DLL のバージョンがオペレーティングシステムに合いません。
Python のインストールが原因ではありません - それ以前にインストールした何かが OS に付属していた DLL を上書きしたのです (おそらく何かの古いソフトでしょうが、もうそれは判断できません)。検索エンジン (例えば Altavista) で
&#8220;CTL3D32&#8221; を探せば、あらゆる種類のインストールプログラムでの同様の問題を訴えるウェブページが何百も何百も現れるでしょう。それらのページにシステムにあった正しいバージョンをダウンロードする方法が指摘されていることでしょう
(Python によって起こされたものではないので、我々には直しようがないのです)。</div></blockquote>
<p>David A Burton はこれを直すための小さなプログラムを書きました。
<a class="reference external" href="http://www.burtonsys.com/downloads.html">http://www.burtonsys.com/downloads.html</a> に行って &#8220;ctl3dfix.zip&#8221; をクリックしてください。</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="gui.html" title="グラフィックユーザインタフェース FAQ"
             >次へ</a> |</li>
        <li class="right" >
          <a href="extending.html" title="拡張と埋め込み FAQ"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" >Python よくある質問</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 1990-2011, Python Software Foundation.
      最終更新: 2011-12-26
      このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/02cb752c6a9e で生成しました。
    </div>
  </body>
</html>