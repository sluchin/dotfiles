

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>13.1. csv — CSV ファイルの読み書き &mdash; Python 2.7ja1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.7ja1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 2.7ja1 documentation 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="Python 2.7ja1 documentation" href="../index.html" />
    <link rel="up" title="13. ファイルフォーマット" href="fileformats.html" />
    <link rel="next" title="13.2. ConfigParser — 設定ファイルの構文解析器" href="configparser.html" />
    <link rel="prev" title="13. ファイルフォーマット" href="fileformats.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/_jp.js"></script>
    
 

  </head>
  <body>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="configparser.html" title="13.2. ConfigParser — 設定ファイルの構文解析器"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="fileformats.html" title="13. ファイルフォーマット"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" >Python 標準ライブラリ</a> &raquo;</li>
          <li><a href="fileformats.html" accesskey="U">13. ファイルフォーマット</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">13.1. <tt class="docutils literal"><span class="pre">csv</span></tt> &#8212; CSV ファイルの読み書き</a><ul>
<li><a class="reference internal" href="#csv-contents">13.1.1. モジュールの内容</a></li>
<li><a class="reference internal" href="#dialect">13.1.2. Dialect クラスと書式化パラメタ</a></li>
<li><a class="reference internal" href="#reader">13.1.3. reader オブジェクト</a></li>
<li><a class="reference internal" href="#writer">13.1.4. writer オブジェクト</a></li>
<li><a class="reference internal" href="#csv-examples">13.1.5. 使用例</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="fileformats.html"
                        title="前の章へ">13. ファイルフォーマット</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="configparser.html"
                        title="次の章へ">13.2. <tt class="docutils literal docutils literal"><span class="pre">ConfigParser</span></tt> &#8212; 設定ファイルの構文解析器</a></p>
  <h3>このページ</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/library/csv.txt"
           rel="nofollow">ソースコードを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-csv">
<span id="csv-csv"></span><h1>13.1. <a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> &#8212; CSV ファイルの読み書き<a class="headerlink" href="#module-csv" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p class="versionadded">
<span class="versionmodified">バージョン 2.3 で追加.</span></p>
<p id="index-0">CSV (Comma Separated Values、カンマ区切り値列) と呼ばれる形式は、スプレッドシートやデータベース間でのデータのインポートやエクスポートにおける最も一般的な形式です。&#8221;CSV 標準&#8221; は存在しないため、 CSV
形式はデータを読み書きする多くのアプリケーション上の操作に応じて定義されているにすぎません。標準がないということは、異なるアプリケーションによって生成されたり取り込まれたりするデータ間では、しばしば微妙な違いが発生するということを意味します。こうした違いのために、複数のデータ源から得られた
CSV ファイルを処理する作業が鬱陶しいものになることがあります。とはいえ、デリミタ (delimiter) やクオート文字の相違はあっても、全体的な形式は十分似通っているため、こうしたデータを効率的に操作し、データの読み書きにおける細々としたことをプログラマから隠蔽するような単一のモジュールを書くことは可能です。</p>
<p><a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールでは、CSV 形式で書かれたテーブル状のデータを読み書きするためのクラスを実装しています。このモジュールを使うことで、プログラマは Excel で使われている CSV  形式に関して詳しい知識をもっていなくても、 &#8220;このデータを Excel で推奨されている形式で書いてください&#8221; とか、 &#8220;データを Excel で作成されたこのファイルから読み出してください&#8221; と言うことができます。プログラマはまた、他のアプリケーションが解釈できる CSV 形式を記述したり、独自の特殊な目的をもった CSV 形式を定義することができます。</p>
<p><a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールの <a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">reader</span></tt></a> および <a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a>
オブジェクトはシーケンス型を読み書きします。プログラマは <a class="reference internal" href="#csv.DictReader" title="csv.DictReader"><tt class="xref py py-class docutils literal"><span class="pre">DictReader</span></tt></a> や <a class="reference internal" href="#csv.DictWriter" title="csv.DictWriter"><tt class="xref py py-class docutils literal"><span class="pre">DictWriter</span></tt></a>
クラスを使うことで、データを辞書形式で読み書きすることもできます。</p>
<div class="admonition note">
<p class="first admonition-title">ノート</p>
<p class="last">このバージョンの <a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールは Unicode 入力をサポートしていません。また、現在のところ、 ASCII NUL
文字に関連したいくつかの問題があります。従って、安全を期すには、全ての入力を UTF-8 または印字可能な ASCII
にしなければなりません。これについては <a class="reference internal" href="#csv-examples"><em>使用例</em></a> 節の例を参照してください。これらの制限は将来取り去られることになっています。</p>
</div>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><span class="target" id="index-1"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0305"><strong>PEP 305</strong></a> - CSV File API</dt>
<dd>Python へのこのモジュールの追加を提案している Python 改良案 (PEP: Python Enhancement Proposal)</dd>
</dl>
</div>
<div class="section" id="csv-contents">
<span id="id1"></span><h2>13.1.1. モジュールの内容<a class="headerlink" href="#csv-contents" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールでは以下の関数を定義しています:</p>
<dl class="function">
<dt id="csv.reader">
<tt class="descclassname">csv.</tt><tt class="descname">reader</tt><big>(</big><em>csvfile[, dialect='excel'][, fmtparam]</em><big>)</big><a class="headerlink" href="#csv.reader" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>与えられた <em>csvfile</em> 内の行を反復処理するような reader  オブジェクトを返します。 <em>csvfile</em> はイテレータ(<a class="reference internal" href="../glossary.html#term-iterator"><em class="xref std std-term">iterator</em></a>)プロトコルをサポートし、 <tt class="xref py py-meth docutils literal"><span class="pre">next()</span></tt> メソッドが呼ばれた際に常に文字列を返すような任意のオブジェクトにすることができます &#8212; ファイルオブジェクトでもリストでも構いません。 <em>csvfile</em> がファイルオブジェクトの場合、ファイルオブジェクトの形式に違いがあるようなプラットフォームでは &#8216;b&#8217;
フラグを付けて開かなければなりません。オプションとして <em>dialect</em> パラメタを与えることができ、特定の CSV 表現形式 (dialect)
特有のパラメタの集合を定義するために使われます。 <em>dialect</em> パラメタは <a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a> クラスのサブクラスのインスタンスか、 <a class="reference internal" href="#csv.list_dialects" title="csv.list_dialects"><tt class="xref py py-func docutils literal"><span class="pre">list_dialects()</span></tt></a> 関数が返す文字列の一つにすることができます。別のオプションである <em>fmtparam</em>
キーワード引数は、現在の表現形式における個々の書式パラメタを上書きするために与えることができます。表現形式および書式化パラメタの詳細については、
<a class="reference internal" href="#csv-fmt-params"><em>Dialect クラスと書式化パラメタ</em></a> 節を参照してください。</p>
<p>csv ファイルから読み込まれた各行は、文字列のリストとして返されます。データ型の変換が自動的に行われることはありません。</p>
<p>短い利用例:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">csv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spamReader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;eggs.csv&#39;</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">,</span> <span class="n">quotechar</span><span class="o">=</span><span class="s">&#39;|&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">spamReader</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
<span class="go">Spam, Spam, Spam, Spam, Spam, Baked Beans</span>
<span class="go">Spam, Lovely Spam, Wonderful Spam</span>
</pre></div>
</div>
<p class="versionchanged">
<span class="versionmodified">バージョン 2.5 で変更: </span>パーサが複数行に亘るクオートされたフィールドに関して厳格になりました。以前は、クオートされたフィールドの中で終端の改行文字無しに行が終わった場合、
返されるフィールドには改行が挿入されていましたが、この振る舞いはフィールドの中に復帰文字を含むようなファイルを読むときに問題を起こしていました。
そこでフィールドに改行文字を挿入せずに返すように改められました。この結果、フィールドに埋め込まれた改行文字が重要ならば、入力は改行文字を保存する
ような仕方で複数行に分割されなければなりません。 .</p>
</dd></dl>

<dl class="function">
<dt id="csv.writer">
<tt class="descclassname">csv.</tt><tt class="descname">writer</tt><big>(</big><em>csvfile[, dialect='excel'][, fmtparam]</em><big>)</big><a class="headerlink" href="#csv.writer" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ユーザが与えたデータをデリミタで区切られた文字列に変換し、与えられたファイルオブジェクトに書き込むための
writer オブジェクトを返します。
<em>csvfile</em> は <tt class="xref py py-func docutils literal"><span class="pre">write()</span></tt> メソッドを持つ任意のオブジェクトです。
<em>csvfile</em> がファイルオブジェクトの場合、 &#8216;b&#8217; フラグが意味を持つプラットフォームでは &#8216;b&#8217; フラグを付けて開かなければなりません。オプションとして <em>dialect</em> 引数を与えることができ、利用するCSV表現形式(dialect)を指定することができます。
<em>dialect</em> パラメタは <a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a> クラスのサブクラスのインスタンスか、 <a class="reference internal" href="#csv.list_dialects" title="csv.list_dialects"><tt class="xref py py-func docutils literal"><span class="pre">list_dialects()</span></tt></a>
関数が返す文字列の1つにすることができます。別のオプション引数である <em>fmtparam</em>
キーワード引数は、現在の表現形式における個々の書式パラメタを上書きするために与えることができます。
<em>dialect</em> と書式パラメタについての詳細は、 <a class="reference internal" href="#csv-fmt-params"><em>Dialect クラスと書式化パラメタ</em></a> 節を参照してください。
DB API
を実装するモジュールとのインタフェースを可能な限り容易にするために、 <a class="reference internal" href="constants.html#None" title="None"><tt class="xref py py-const docutils literal"><span class="pre">None</span></tt></a> は空文字列として書き込まれます。この処理は可逆な変換ではありませんが、SQL で NULL データ値を CSV にダンプする処理を、 <tt class="docutils literal"><span class="pre">cursor.fetch*</span></tt> 呼び出しによって返されたデータを前処理することなく簡単に行うことができます。他の非文字列データは、書き出される前に <a class="reference internal" href="functions.html#str" title="str"><tt class="xref py py-func docutils literal"><span class="pre">str()</span></tt></a> を使って文字列に変換されます。</p>
<p>短い利用例:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">csv</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spamWriter</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;eggs.csv&#39;</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39; &#39;</span><span class="p">,</span>
<span class="gp">... </span>                        <span class="n">quotechar</span><span class="o">=</span><span class="s">&#39;|&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_MINIMAL</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spamWriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s">&#39;Spam&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s">&#39;Baked Beans&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">spamWriter</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s">&#39;Spam&#39;</span><span class="p">,</span> <span class="s">&#39;Lovely Spam&#39;</span><span class="p">,</span> <span class="s">&#39;Wonderful Spam&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="csv.register_dialect">
<tt class="descclassname">csv.</tt><tt class="descname">register_dialect</tt><big>(</big><em>name[, dialect][, fmtparam]</em><big>)</big><a class="headerlink" href="#csv.register_dialect" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>dialect</em> を <em>name</em> と関連付けます。 <em>name</em> は文字列か Unicode オブジェクトでなければなりません。表現形式(dialect)は
<a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a> のサブクラスを渡すか、またはキーワード引数 <em>fmtparam</em> 、もしくは両方で指定できますが、キーワード引数の方が優先されます。表現形式と書式化パラメタについての詳細は、 <a class="reference internal" href="#csv-fmt-params"><em>Dialect クラスと書式化パラメタ</em></a> 節を参照してください。</p>
</dd></dl>

<dl class="function">
<dt id="csv.unregister_dialect">
<tt class="descclassname">csv.</tt><tt class="descname">unregister_dialect</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#csv.unregister_dialect" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>name</em> に関連づけられた表現形式を表現形式レジストリから削除します。 <em>name</em> が表現形式名でない場合には <a class="reference internal" href="#csv.Error" title="csv.Error"><tt class="xref py py-exc docutils literal"><span class="pre">Error</span></tt></a> を送出します。</p>
</dd></dl>

<dl class="function">
<dt id="csv.get_dialect">
<tt class="descclassname">csv.</tt><tt class="descname">get_dialect</tt><big>(</big><em>name</em><big>)</big><a class="headerlink" href="#csv.get_dialect" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>name</em> に関連づけられた表現形式を返します。 <em>name</em> が表現形式名でない場合には <a class="reference internal" href="#csv.Error" title="csv.Error"><tt class="xref py py-exc docutils literal"><span class="pre">Error</span></tt></a> を送出します。</p>
<p class="versionchanged">
<span class="versionmodified">バージョン 2.5 で変更.</span></p>
</dd></dl>

<dl class="function">
<dt id="csv.list_dialects">
<tt class="descclassname">csv.</tt><tt class="descname">list_dialects</tt><big>(</big><big>)</big><a class="headerlink" href="#csv.list_dialects" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>登録されている全ての表現形式を返します。</p>
</dd></dl>

<dl class="function">
<dt id="csv.field_size_limit">
<tt class="descclassname">csv.</tt><tt class="descname">field_size_limit</tt><big>(</big><span class="optional">[</span><em>new_limit</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#csv.field_size_limit" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>パーサが許容する現在の最大フィールドサイズを返します。 <em>new_limit</em> が渡されたときは、その値が新しい上限になります。</p>
<p class="versionadded">
<span class="versionmodified">バージョン 2.5 で追加.</span></p>
</dd></dl>

<p><a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールでは以下のクラスを定義しています:</p>
<dl class="class">
<dt id="csv.DictReader">
<em class="property">class </em><tt class="descclassname">csv.</tt><tt class="descname">DictReader</tt><big>(</big><em>csvfile</em><span class="optional">[</span>, <em>fieldnames=None</em><span class="optional">[</span>, <em>restkey=None</em><span class="optional">[</span>, <em>restval=None</em><span class="optional">[</span>, <em>dialect='excel'</em><span class="optional">[</span>, <em>*args</em>, <em>**kwds</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#csv.DictReader" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>省略可能な <em>fieldnames</em> パラメタで与えられたキーを読み出された情報に対応付ける他は正規の reader のように動作するオブジェクトを生成します。
<em>fieldnames</em> パラメタが無い場合には、 <em>csvfile</em> の最初の行の値がフィールド名として利用されます。読み出された行が <em>fieldnames</em> のシーケンスよりも多くのフィールドを持っていた場合、残りのフィールドデータは <em>restkey</em> の値をキーとするシーケンスに追加されます。読み出された行が <em>fieldnames</em> のシーケンスよりも少ないフィールドしか持たない場合、残りのキーはオプションの <em>restval</em> パラメタに指定された値を取ります。その他の省略可能またはキーワード形式のパラメタはベースになっている
<a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">reader</span></tt></a> のインスタンスに渡されます。</p>
</dd></dl>

<dl class="class">
<dt id="csv.DictWriter">
<em class="property">class </em><tt class="descclassname">csv.</tt><tt class="descname">DictWriter</tt><big>(</big><em>csvfile</em>, <em>fieldnames</em><span class="optional">[</span>, <em>restval=''</em><span class="optional">[</span>, <em>extrasaction='raise'</em><span class="optional">[</span>, <em>dialect='excel'</em><span class="optional">[</span>, <em>*args</em>, <em>**kwds</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><big>)</big><a class="headerlink" href="#csv.DictWriter" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>辞書を出力行に対応付ける他は正規の writer のように動作するオブジェクトを生成します。 <em>fieldnames</em> パラメタには、辞書中の
<tt class="xref py py-meth docutils literal"><span class="pre">writerow()</span></tt> メソッドに渡される値がどの順番で <em>csvfile</em> に書き出されるかを指定します。オプションの <em>restval</em>
パラメタは、 <em>fieldnames</em> 内のキーが辞書中にない場合に書き出される値を指定します。 <tt class="xref py py-meth docutils literal"><span class="pre">writerow()</span></tt> メソッドに渡された辞書に、
<em>fieldnames</em> 内には存在しないキーが入っている場合、オプションの <em>extraaction</em>
パラメタでどのような動作を行うかを指定します。この値が <tt class="docutils literal"><span class="pre">'raise'</span></tt> に設定されている場合 <a class="reference internal" href="exceptions.html#exceptions.ValueError" title="exceptions.ValueError"><tt class="xref py py-exc docutils literal"><span class="pre">ValueError</span></tt></a> が送出されます。
<tt class="docutils literal"><span class="pre">'ignore'</span></tt> に設定されている場合、辞書の余分の値は無視されます。その他のパラメタはベースになっている <a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a>
のインスタンスに渡されます。</p>
<p><a class="reference internal" href="#csv.DictReader" title="csv.DictReader"><tt class="xref py py-class docutils literal"><span class="pre">DictReader</span></tt></a> クラスとは違い、 <a class="reference internal" href="#csv.DictWriter" title="csv.DictWriter"><tt class="xref py py-class docutils literal"><span class="pre">DictWriter</span></tt></a> の <em>fieldnames</em>
パラメータは省略可能ではありません。Pythonの <a class="reference internal" href="stdtypes.html#dict" title="dict"><tt class="xref py py-class docutils literal"><span class="pre">dict</span></tt></a> オブジェクトは整列されていないので、列が <em>csvfile</em> に書かれるべき順序を推定するための十分な情報はありません。</p>
</dd></dl>

<dl class="class">
<dt id="csv.Dialect">
<em class="property">class </em><tt class="descclassname">csv.</tt><tt class="descname">Dialect</tt><a class="headerlink" href="#csv.Dialect" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a> クラスはコンテナクラスで、基本的な用途としては、その属性を特定の <a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">reader</span></tt></a> や
<a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a> インスタンスのパラメタを定義するために用います。</p>
</dd></dl>

<dl class="class">
<dt id="csv.excel">
<em class="property">class </em><tt class="descclassname">csv.</tt><tt class="descname">excel</tt><a class="headerlink" href="#csv.excel" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.excel" title="csv.excel"><tt class="xref py py-class docutils literal"><span class="pre">excel</span></tt></a> クラスは Excel で生成される CSV ファイルの通常のプロパティを定義します。これは <tt class="docutils literal"><span class="pre">'excel'</span></tt> という名前の dialect として登録されています。</p>
</dd></dl>

<dl class="class">
<dt id="csv.excel_tab">
<em class="property">class </em><tt class="descclassname">csv.</tt><tt class="descname">excel_tab</tt><a class="headerlink" href="#csv.excel_tab" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.excel" title="csv.excel"><tt class="xref py py-class docutils literal"><span class="pre">excel</span></tt></a> クラスは Excel で生成されるタブ分割ファイルの通常のプロパティを定義します。これは <tt class="docutils literal"><span class="pre">'excel-tab'</span></tt> という名前の dialect として登録されています。</p>
</dd></dl>

<dl class="class">
<dt id="csv.Sniffer">
<em class="property">class </em><tt class="descclassname">csv.</tt><tt class="descname">Sniffer</tt><big>(</big><span class="optional">[</span><em>sample=16384</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#csv.Sniffer" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.Sniffer" title="csv.Sniffer"><tt class="xref py py-class docutils literal"><span class="pre">Sniffer</span></tt></a> クラスは CSV ファイルの書式を推理するために用いられるクラスです。</p>
<p><a class="reference internal" href="#csv.Sniffer" title="csv.Sniffer"><tt class="xref py py-class docutils literal"><span class="pre">Sniffer</span></tt></a> クラスではメソッドを二つ提供しています:</p>
<dl class="method">
<dt id="csv.Sniffer.sniff">
<tt class="descname">sniff</tt><big>(</big><em>sample</em><span class="optional">[</span>, <em>delimiters=None</em><span class="optional">]</span><big>)</big><a class="headerlink" href="#csv.Sniffer.sniff" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>与えられた <em>sample</em> を解析し、発見されたパラメタを反映した <a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a> サブクラスを返します。オプションの
<em>delimiters</em> パラメタを与えた場合、有効なデリミタ文字を含んでいるはずの文字列として解釈されます。</p>
</dd></dl>

<dl class="method">
<dt id="csv.Sniffer.has_header">
<tt class="descname">has_header</tt><big>(</big><em>sample</em><big>)</big><a class="headerlink" href="#csv.Sniffer.has_header" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>(CSV 形式と仮定される) サンプルテキストを解析して、最初の行がカラムヘッダの羅列のように推察される場合 <a class="reference internal" href="constants.html#True" title="True"><tt class="xref py py-const docutils literal"><span class="pre">True</span></tt></a> を返します。</p>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#csv.Sniffer" title="csv.Sniffer"><tt class="xref py py-class docutils literal"><span class="pre">Sniffer</span></tt></a> の利用例:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">csvfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">&quot;example.csv&quot;</span><span class="p">,</span> <span class="s">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">dialect</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">Sniffer</span><span class="p">()</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="n">csvfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span>
<span class="n">csvfile</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">csvfile</span><span class="p">,</span> <span class="n">dialect</span><span class="p">)</span>
<span class="c"># ... process CSV file contents here ...</span>
</pre></div>
</div>
<p><a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールでは以下の定数を定義しています:</p>
<dl class="data">
<dt id="csv.QUOTE_ALL">
<tt class="descclassname">csv.</tt><tt class="descname">QUOTE_ALL</tt><a class="headerlink" href="#csv.QUOTE_ALL" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a> オブジェクトに対し、全てのフィールドをクオートするように指示します。</p>
</dd></dl>

<dl class="data">
<dt id="csv.QUOTE_MINIMAL">
<tt class="descclassname">csv.</tt><tt class="descname">QUOTE_MINIMAL</tt><a class="headerlink" href="#csv.QUOTE_MINIMAL" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a> オブジェクトに対し、 <em>delimiter</em> 、 <em>quotechar</em> または <em>lineterminator</em>
に含まれる任意の文字のような特別な文字を含むフィールドだけをクオートするように指示します。</p>
</dd></dl>

<dl class="data">
<dt id="csv.QUOTE_NONNUMERIC">
<tt class="descclassname">csv.</tt><tt class="descname">QUOTE_NONNUMERIC</tt><a class="headerlink" href="#csv.QUOTE_NONNUMERIC" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a> オブジェクトに対し、全ての非数値フィールドをクオートするように指示します。</p>
<p><a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">reader</span></tt></a> に対しては、クオートされていない全てのフィールドを <em>float</em> 型に変換するよう指示します。</p>
</dd></dl>

<dl class="data">
<dt id="csv.QUOTE_NONE">
<tt class="descclassname">csv.</tt><tt class="descname">QUOTE_NONE</tt><a class="headerlink" href="#csv.QUOTE_NONE" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a> オブジェクトに対し、フィールドを決してクオートしないように指示します。現在の <em>delimiter</em> が出力データ中に現れた場合、現在設定されている <em>escapechar</em> 文字が前に付けられます。 <em>escapechar</em> がセットされていない場合、エスケープが必要な文字に遭遇した writer は <a class="reference internal" href="#csv.Error" title="csv.Error"><tt class="xref py py-exc docutils literal"><span class="pre">Error</span></tt></a> を送出します。</p>
<p><a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">reader</span></tt></a> に対しては、クオート文字の特別扱いをしないように指示します。</p>
</dd></dl>

<p><a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールでは以下の例外を定義しています:</p>
<dl class="exception">
<dt id="csv.Error">
<em class="property">exception </em><tt class="descclassname">csv.</tt><tt class="descname">Error</tt><a class="headerlink" href="#csv.Error" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>全ての関数において、エラーが検出された際に送出される例外です。</p>
</dd></dl>

</div>
<div class="section" id="dialect">
<span id="csv-fmt-params"></span><h2>13.1.2. Dialect クラスと書式化パラメタ<a class="headerlink" href="#dialect" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>レコードに対する入出力形式の指定をより簡単にするために、特定の書式化パラメタは表現形式 (dialect) にまとめてグループ化されます。表現形式は
<a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a> クラスのサブクラスで、様々なクラス特有のメソッドと、 <tt class="xref py py-meth docutils literal"><span class="pre">validate()</span></tt> メソッドを一つ持っています。
<a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">reader</span></tt></a> または <a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a> オブジェクトを生成するとき、プログラマは文字列または <a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a>
クラスのサブクラスを表現形式パラメタとして渡さなければなりません。さらに、 <em>dialect</em> パラメタの代りに、プログラマは上で定義されている属性と同じ名前を持つ個々の書式化パラメタを <a class="reference internal" href="#csv.Dialect" title="csv.Dialect"><tt class="xref py py-class docutils literal"><span class="pre">Dialect</span></tt></a> クラスに指定することができます。</p>
<p>Dialect は以下の属性をサポートしています:</p>
<dl class="attribute">
<dt id="csv.Dialect.delimiter">
<tt class="descclassname">Dialect.</tt><tt class="descname">delimiter</tt><a class="headerlink" href="#csv.Dialect.delimiter" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>フィールド間を分割するのに用いられる 1 文字からなる文字列です。デフォルトでは <tt class="docutils literal"><span class="pre">','</span></tt> です。</p>
</dd></dl>

<dl class="attribute">
<dt id="csv.Dialect.doublequote">
<tt class="descclassname">Dialect.</tt><tt class="descname">doublequote</tt><a class="headerlink" href="#csv.Dialect.doublequote" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>フィールド内に現れた <em>quotechar</em> のインスタンスで、クオートではないその文字自身でなければならない文字をどのようにクオートするかを制御します。
<a class="reference internal" href="constants.html#True" title="True"><tt class="xref py py-const docutils literal"><span class="pre">True</span></tt></a> の場合、この文字は二重化されます。 <a class="reference internal" href="constants.html#False" title="False"><tt class="xref py py-const docutils literal"><span class="pre">False</span></tt></a> の場合、 <em>escapechar</em> は <em>quotechar</em>
の前に置かれます。デフォルトでは <a class="reference internal" href="constants.html#True" title="True"><tt class="xref py py-const docutils literal"><span class="pre">True</span></tt></a> です。</p>
<p>出力においては、 <em>doublequote</em> が <a class="reference internal" href="constants.html#False" title="False"><tt class="xref py py-const docutils literal"><span class="pre">False</span></tt></a> で <em>escapechar</em> がセットされていない場合、フィールド内に
<em>quotechar</em> が現れると <a class="reference internal" href="#csv.Error" title="csv.Error"><tt class="xref py py-exc docutils literal"><span class="pre">Error</span></tt></a> が送出されます。</p>
</dd></dl>

<dl class="attribute">
<dt id="csv.Dialect.escapechar">
<tt class="descclassname">Dialect.</tt><tt class="descname">escapechar</tt><a class="headerlink" href="#csv.Dialect.escapechar" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>writer が、 <em>quoting</em> が <a class="reference internal" href="#csv.QUOTE_NONE" title="csv.QUOTE_NONE"><tt class="xref py py-const docutils literal"><span class="pre">QUOTE_NONE</span></tt></a> に設定されている場合に <em>delimiter</em>
をエスケープするため、および、 <em>doublequote</em> が <a class="reference internal" href="constants.html#False" title="False"><tt class="xref py py-const docutils literal"><span class="pre">False</span></tt></a> の場合に <em>quotechar</em>
をエスケープするために用いられる、 1 文字からなる文字列です。読み込み時には <em>escapechar</em> はそれに引き続く文字の特別な意味を取り除きます。デフォルトでは <a class="reference internal" href="constants.html#None" title="None"><tt class="xref py py-const docutils literal"><span class="pre">None</span></tt></a> で、エスケープを行ないません。</p>
</dd></dl>

<dl class="attribute">
<dt id="csv.Dialect.lineterminator">
<tt class="descclassname">Dialect.</tt><tt class="descname">lineterminator</tt><a class="headerlink" href="#csv.Dialect.lineterminator" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-class docutils literal"><span class="pre">writer</span></tt></a> が作り出す各行を終端する際に用いられる文字列です。デフォルトでは <tt class="docutils literal"><span class="pre">'\r\n'</span></tt> です。</p>
<div class="admonition note">
<p class="first admonition-title">ノート</p>
<p class="last"><a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">reader</span></tt></a> は <tt class="docutils literal"><span class="pre">'\r'</span></tt> または <tt class="docutils literal"><span class="pre">'\n'</span></tt> のどちらかを行末と認識するようにハードコードされており、
<em>lineterminator</em> を無視します。この振る舞いは将来変更されるかもしれません。</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="csv.Dialect.quotechar">
<tt class="descclassname">Dialect.</tt><tt class="descname">quotechar</tt><a class="headerlink" href="#csv.Dialect.quotechar" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>delimiter</em> や <em>quotechar</em> といった特殊文字を含むか、改行文字を含むフィールドをクオートする際に用いられる 1
文字からなる文字列です。デフォルトでは <tt class="docutils literal"><span class="pre">'&quot;'</span></tt> です。</p>
</dd></dl>

<dl class="attribute">
<dt id="csv.Dialect.quoting">
<tt class="descclassname">Dialect.</tt><tt class="descname">quoting</tt><a class="headerlink" href="#csv.Dialect.quoting" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>クオートがいつ writer によって生成されるか、また reader によって認識されるかを制御します。 <tt class="xref py py-const docutils literal"><span class="pre">QUOTE_*</span></tt> 定数のいずれか
(<a class="reference internal" href="#csv-contents"><em>モジュールの内容</em></a> 節参照) をとることができ、デフォルトでは <a class="reference internal" href="#csv.QUOTE_MINIMAL" title="csv.QUOTE_MINIMAL"><tt class="xref py py-const docutils literal"><span class="pre">QUOTE_MINIMAL</span></tt></a> です。</p>
</dd></dl>

<dl class="attribute">
<dt id="csv.Dialect.skipinitialspace">
<tt class="descclassname">Dialect.</tt><tt class="descname">skipinitialspace</tt><a class="headerlink" href="#csv.Dialect.skipinitialspace" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="constants.html#True" title="True"><tt class="xref py py-const docutils literal"><span class="pre">True</span></tt></a> の場合、 <em>delimiter</em> の直後に続く空白は無視されます。デフォルトでは <a class="reference internal" href="constants.html#False" title="False"><tt class="xref py py-const docutils literal"><span class="pre">False</span></tt></a> です。</p>
</dd></dl>

</div>
<div class="section" id="reader">
<h2>13.1.3. reader オブジェクト<a class="headerlink" href="#reader" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>reader オブジェクト(<a class="reference internal" href="#csv.DictReader" title="csv.DictReader"><tt class="xref py py-class docutils literal"><span class="pre">DictReader</span></tt></a> インスタンス、および  <a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-func docutils literal"><span class="pre">reader()</span></tt></a> 関数によって返されたオブジェクト)
は、以下の public なメソッドを持っています:</p>
<dl class="method">
<dt id="csv.csvreader.next">
<tt class="descclassname">csvreader.</tt><tt class="descname">next</tt><big>(</big><big>)</big><a class="headerlink" href="#csv.csvreader.next" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>reader の反復可能なオブジェクトから、現在の表現形式に基づいて次の行を解析して返します。</p>
</dd></dl>

<p>reader オブジェクトには以下の公開属性があります:</p>
<dl class="attribute">
<dt id="csv.csvreader.dialect">
<tt class="descclassname">csvreader.</tt><tt class="descname">dialect</tt><a class="headerlink" href="#csv.csvreader.dialect" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>パーサで使われる表現形式の読み取り専用の記述です。</p>
</dd></dl>

<dl class="attribute">
<dt id="csv.csvreader.line_num">
<tt class="descclassname">csvreader.</tt><tt class="descname">line_num</tt><a class="headerlink" href="#csv.csvreader.line_num" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ソースイテレータから読んだ行数です。この数は返されるレコードの数とは、レコードが複数行に亘ることがあるので、一致しません。</p>
<p class="versionadded">
<span class="versionmodified">バージョン 2.5 で追加.</span></p>
</dd></dl>

<p>DictReader オブジェクトは、以下のpublicな属性を持っています:</p>
<dl class="attribute">
<dt id="csv.csvreader.fieldnames">
<tt class="descclassname">csvreader.</tt><tt class="descname">fieldnames</tt><a class="headerlink" href="#csv.csvreader.fieldnames" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>オブジェクトを生成するときに渡されなかった場合、この属性は最初のアクセス時か、ファイルから最初のレコードを読み出したときに初期化されます。</p>
<p class="versionchanged">
<span class="versionmodified">バージョン 2.6 で変更.</span></p>
</dd></dl>

</div>
<div class="section" id="writer">
<h2>13.1.4. writer オブジェクト<a class="headerlink" href="#writer" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><tt class="xref py py-class docutils literal"><span class="pre">Writer</span></tt> オブジェクト(<a class="reference internal" href="#csv.DictWriter" title="csv.DictWriter"><tt class="xref py py-class docutils literal"><span class="pre">DictWriter</span></tt></a> インスタンス、および  <a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-func docutils literal"><span class="pre">writer()</span></tt></a>
関数によって返されたオブジェクト) は、以下の public なメソッドを持っています:</p>
<p><tt class="xref py py-class docutils literal"><span class="pre">Writer</span></tt> オブジェクト(<a class="reference internal" href="#csv.writer" title="csv.writer"><tt class="xref py py-func docutils literal"><span class="pre">writer()</span></tt></a> で生成される  <a class="reference internal" href="#csv.DictWriter" title="csv.DictWriter"><tt class="xref py py-class docutils literal"><span class="pre">DictWriter</span></tt></a>
クラスのインスタンス）は、以下の公開メソッドを持っています。 <em>row</em> には、 <tt class="xref py py-class docutils literal"><span class="pre">Writer</span></tt> オブジェクトの場合には文字列か数値のシーケンスを指定し、 <a class="reference internal" href="#csv.DictWriter" title="csv.DictWriter"><tt class="xref py py-class docutils literal"><span class="pre">DictWriter</span></tt></a> オブジェクトの場合はフィールド名をキーとして対応する文字列か数値を格納した辞書オブジェクトを指定します(数値は
<a class="reference internal" href="functions.html#str" title="str"><tt class="xref py py-func docutils literal"><span class="pre">str()</span></tt></a> で変換されます)。複素数を出力する場合、値をかっこで囲んで出力します。このため、CSV
ファイルを読み込むアプリケーションで（そのアプリケーションが複素数をサポートしていたとしても）問題が発生する場合があります。</p>
<dl class="method">
<dt id="csv.csvwriter.writerow">
<tt class="descclassname">csvwriter.</tt><tt class="descname">writerow</tt><big>(</big><em>row</em><big>)</big><a class="headerlink" href="#csv.csvwriter.writerow" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>row</em> パラメタを現在の表現形式に基づいて書式化し、 writer のファイルオブジェクトに書き込みます。</p>
</dd></dl>

<dl class="method">
<dt id="csv.csvwriter.writerows">
<tt class="descclassname">csvwriter.</tt><tt class="descname">writerows</tt><big>(</big><em>rows</em><big>)</big><a class="headerlink" href="#csv.csvwriter.writerows" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>rows</em> パラメタ(上記 <em>row</em> のリスト)全てを現在の表現形式に基づいて書式化し、  writer のファイルオブジェクトに書き込みます。</p>
</dd></dl>

<p>writer オブジェクトには以下の公開属性があります:</p>
<dl class="attribute">
<dt id="csv.csvwriter.dialect">
<tt class="descclassname">csvwriter.</tt><tt class="descname">dialect</tt><a class="headerlink" href="#csv.csvwriter.dialect" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>writer で使われる表現形式の読み取り専用の記述です。</p>
</dd></dl>

<p>DictWriter のオブジェクトは以下の public メソッドを持っています。</p>
<dl class="method">
<dt id="csv.DictWriter.writeheader">
<tt class="descclassname">DictWriter.</tt><tt class="descname">writeheader</tt><big>(</big><big>)</big><a class="headerlink" href="#csv.DictWriter.writeheader" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>(コンストラクタで指定された)フィールド名の行を出力します。</p>
<p class="versionadded">
<span class="versionmodified">バージョン 2.7 で追加.</span></p>
</dd></dl>

</div>
<div class="section" id="csv-examples">
<span id="id2"></span><h2>13.1.5. 使用例<a class="headerlink" href="#csv-examples" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>最も簡単な CSV ファイル読み込みの例です:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;some.csv&#39;</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">row</span>
</pre></div>
</div>
<p>別の書式での読み込み:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;passwd&#39;</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">row</span>
</pre></div>
</div>
<p>上に対して、単純な書き込みのプログラム例は以下のようになります。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;some.csv&#39;</span><span class="p">,</span> <span class="s">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">someiterable</span><span class="p">)</span>
</pre></div>
</div>
<p>新しい表現形式の登録:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="n">csv</span><span class="o">.</span><span class="n">register_dialect</span><span class="p">(</span><span class="s">&#39;unixpwd&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&#39;:&#39;</span><span class="p">,</span> <span class="n">quoting</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">QUOTE_NONE</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s">&#39;passwd&#39;</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s">&#39;unixpwd&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>もう少し手の込んだ reader の使い方 &#8212; エラーを捉えてレポートします。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span><span class="o">,</span> <span class="nn">sys</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&#39;some.csv&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">reader</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">row</span>
    <span class="k">except</span> <span class="n">csv</span><span class="o">.</span><span class="n">Error</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="s">&#39;file </span><span class="si">%s</span><span class="s">, line </span><span class="si">%d</span><span class="s">: </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">reader</span><span class="o">.</span><span class="n">line_num</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
</pre></div>
</div>
<p>このモジュールは文字列の解析は直接サポートしませんが、簡単にできます。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">([</span><span class="s">&#39;one,two,three&#39;</span><span class="p">]):</span>
    <span class="k">print</span> <span class="n">row</span>
</pre></div>
</div>
<p><a class="reference internal" href="#module-csv" title="csv: デリミタで区切られた形式のファイルに対するテーブル状データ読み書き。"><tt class="xref py py-mod docutils literal"><span class="pre">csv</span></tt></a> モジュールは直接は Unicode の読み書きをサポートしませんが、 ASCII NUL
文字に関わる問題のために8ビットクリーンに書き込みます。ですから、NUL を使う UTF-16 のようなエンコーディングを避ける限りエンコード・デコードを行なう関数やクラスを書くことができます。 UTF-8 がお勧めです。</p>
<p>以下の <tt class="xref py py-func docutils literal"><span class="pre">unicode_csv_reader()</span></tt> は Unicode の CSV データ (Unicode 文字列のリスト)を扱うための
<a class="reference internal" href="#csv.reader" title="csv.reader"><tt class="xref py py-class docutils literal"><span class="pre">csv.reader</span></tt></a> をラップするジェネレータ(<a class="reference internal" href="../glossary.html#term-generator"><em class="xref std std-term">generator</em></a>)です。 <tt class="xref py py-func docutils literal"><span class="pre">utf_8_encoder()</span></tt> は一度に 1 文字列(または行) ずつ
Unicode 文字列を UTF-8 としてエンコードするジェネレータです。エンコードされた文字列は CSV reader により分解され、
<tt class="xref py py-func docutils literal"><span class="pre">unicode_csv_reader()</span></tt> が UTF-8 エンコードの分解された文字列をデコードして Unicode に戻します。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span>

<span class="k">def</span> <span class="nf">unicode_csv_reader</span><span class="p">(</span><span class="n">unicode_csv_data</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c"># csv.py doesn&#39;t do Unicode; encode temporarily as UTF-8:</span>
    <span class="n">csv_reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">utf_8_encoder</span><span class="p">(</span><span class="n">unicode_csv_data</span><span class="p">),</span>
                            <span class="n">dialect</span><span class="o">=</span><span class="n">dialect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv_reader</span><span class="p">:</span>
        <span class="c"># decode UTF-8 back to Unicode, cell by cell:</span>
        <span class="k">yield</span> <span class="p">[</span><span class="nb">unicode</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="s">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">utf_8_encoder</span><span class="p">(</span><span class="n">unicode_csv_data</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">unicode_csv_data</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">line</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>その他のエンコーディングには以下の <tt class="xref py py-class docutils literal"><span class="pre">UnicodeReader</span></tt> クラスと <tt class="xref py py-class docutils literal"><span class="pre">UnicodeWriter</span></tt>
クラスが使えます。二つのクラスは <em>encoding</em> パラメータをコンストラクタで取り、本物の reader や writer に渡されるデータが UTF-8
でエンコードされていることを保証します。</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">csv</span><span class="o">,</span> <span class="nn">codecs</span><span class="o">,</span> <span class="nn">cStringIO</span>

<span class="k">class</span> <span class="nc">UTF8Recoder</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Iterator that reads an encoded stream and reencodes the input to UTF-8</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">getreader</span><span class="p">(</span><span class="n">encoding</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">UnicodeReader</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A CSV reader which will iterate over lines in the CSV file &quot;f&quot;,</span>
<span class="sd">    which is encoded in the given encoding.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">UTF8Recoder</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">dialect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">next</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">row</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="nb">unicode</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

<span class="k">class</span> <span class="nc">UnicodeWriter</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A CSV writer which will write rows to CSV file &quot;f&quot;,</span>
<span class="sd">    which is encoded in the given encoding.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">csv</span><span class="o">.</span><span class="n">excel</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&quot;utf-8&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="c"># Redirect output to a queue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span> <span class="o">=</span> <span class="n">cStringIO</span><span class="o">.</span><span class="n">StringIO</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="p">,</span> <span class="n">dialect</span><span class="o">=</span><span class="n">dialect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span> <span class="o">=</span> <span class="n">f</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">getincrementalencoder</span><span class="p">(</span><span class="n">encoding</span><span class="p">)()</span>

    <span class="k">def</span> <span class="nf">writerow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">row</span><span class="p">])</span>
        <span class="c"># Fetch UTF-8 output from the queue ...</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="c"># ... and reencode it into the target encoding</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encoder</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c"># write to the target stream</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stream</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c"># empty queue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">queue</span><span class="o">.</span><span class="n">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writerows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="configparser.html" title="13.2. ConfigParser — 設定ファイルの構文解析器"
             >次へ</a> |</li>
        <li class="right" >
          <a href="fileformats.html" title="13. ファイルフォーマット"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" >Python 標準ライブラリ</a> &raquo;</li>
          <li><a href="fileformats.html" >13. ファイルフォーマット</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 1990-2011, Python Software Foundation.
      最終更新: 2011-12-26
      このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/02cb752c6a9e で生成しました。
    </div>
  </body>
</html>