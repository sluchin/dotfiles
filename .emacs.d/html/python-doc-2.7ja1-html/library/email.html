

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>18.1. email — 電子メールと MIME 処理のためのパッケージ &mdash; Python 2.7ja1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.7ja1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 2.7ja1 documentation 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="Python 2.7ja1 documentation" href="../index.html" />
    <link rel="up" title="18. インターネット上のデータの操作" href="netdata.html" />
    <link rel="next" title="18.1.1. email: 電子メールメッセージの表現" href="email.message.html" />
    <link rel="prev" title="18. インターネット上のデータの操作" href="netdata.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/_jp.js"></script>
    
 

  </head>
  <body>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="email.message.html" title="18.1.1. email: 電子メールメッセージの表現"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="netdata.html" title="18. インターネット上のデータの操作"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" >Python 標準ライブラリ</a> &raquo;</li>
          <li><a href="netdata.html" accesskey="U">18. インターネット上のデータの操作</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">18.1. <tt class="docutils literal"><span class="pre">email</span></tt> &#8212; 電子メールと MIME 処理のためのパッケージ</a><ul>
<li><a class="reference internal" href="#email-pkg-history">18.1.12. パッケージの履歴</a></li>
<li><a class="reference internal" href="#mimelib">18.1.13. <tt class="docutils literal"><span class="pre">mimelib</span></tt> との違い</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="netdata.html"
                        title="前の章へ">18. インターネット上のデータの操作</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="email.message.html"
                        title="次の章へ">18.1.1. <tt class="docutils literal"><span class="pre">email</span></tt>: 電子メールメッセージの表現</a></p>
  <h3>このページ</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/library/email.txt"
           rel="nofollow">ソースコードを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-email">
<span id="email-mime"></span><h1>18.1. <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> &#8212; 電子メールと MIME 処理のためのパッケージ<a class="headerlink" href="#module-email" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p class="versionadded">
<span class="versionmodified">バージョン 2.2 で追加.</span></p>
<p><a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージは電子メールのメッセージを管理するライブラリです。これには MIME やそれ以外の <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2822.html"><strong>RFC 2822</strong></a> ベースのメッセージ文書もふくまれます。このパッケージはいくつかの古い標準パッケージ、 <a class="reference internal" href="rfc822.html#module-rfc822" title="rfc822: RFC 2822 形式のメールメッセージを解釈します。 (撤廃)"><tt class="xref py py-mod docutils literal"><span class="pre">rfc822</span></tt></a>, <a class="reference internal" href="mimetools.html#module-mimetools" title="mimetools: MIME-スタイルのメッセージ本体を解析するためのツール。 (撤廃)"><tt class="xref py py-mod docutils literal"><span class="pre">mimetools</span></tt></a>,
<a class="reference internal" href="multifile.html#module-multifile" title="multifile: MIME データのような、個別の部分を含んだファイル群に対する\ 読み出しのサポート。 (撤廃)"><tt class="xref py py-mod docutils literal"><span class="pre">multifile</span></tt></a> などにふくまれていた機能のほとんどを持ち、くわえて標準ではなかった
<tt class="xref py py-mod docutils literal"><span class="pre">mimecntl</span></tt> などの機能もふくんでいます。このパッケージは、とくに電子メールのメッセージを SMTP (<span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2821.html"><strong>RFC 2821</strong></a>)、
NNTP、その他のサーバに送信するために作られているというわけでは <em>ありません</em> 。それは <a class="reference internal" href="smtplib.html#module-smtplib" title="smtplib: SMTP プロトコルクライアント (ソケットが必要です)。"><tt class="xref py py-mod docutils literal"><span class="pre">smtplib</span></tt></a>, <a class="reference internal" href="nntplib.html#module-nntplib" title="nntplib: NNTP プロトコルクライアント (ソケットを必要とします)。"><tt class="xref py py-mod docutils literal"><span class="pre">nntplib</span></tt></a> モジュールなどの機能です。
<a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージは <span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2822.html"><strong>RFC 2822</strong></a> に加えて、
<span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2045.html"><strong>RFC 2045</strong></a>, <span class="target" id="index-4"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2046.html"><strong>RFC 2046</strong></a>, <span class="target" id="index-5"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2047.html"><strong>RFC 2047</strong></a> および <span class="target" id="index-6"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2231.html"><strong>RFC 2231</strong></a> など MIME 関連の
RFC をサポートしており、できるかぎり RFC に準拠することをめざしています。</p>
<p><a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージの一番の特徴は、電子メールの内部表現である
<em>オブジェクトモデル</em> と、電子メールメッセージの解析および生成とを分離していることです。
<a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージを使うアプリケーションは基本的にはオブジェクトを処理することができます。メッセージに子オブジェクトを追加したり、メッセージから子オブジェクトを削除したり、内容を完全に並べかえたり、といったことができます。フラットなテキスト文書からオブジェクトモデルへの変換、またそこからフラットな文書へと戻す変換はそれぞれ別々の解析器 (パーサ) と生成器 (ジェネレータ) が担当しています。また、一般的な MIME オブジェクトタイプのいくつかについては手軽なサブクラスが存在しており、メッセージフィールド値を抽出したり解析したり、
RFC 準拠の日付を生成したりなどのよくおこわれるタスクについてはいくつかの雑用ユーティリティもついています。</p>
<p>以下の節では <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージの機能を説明します。説明の順序は多くのアプリケーションで一般的な使用順序にもとづいています。まず、電子メールメッセージをファイルあるいはその他のソースからフラットなテキスト文書として読み込み、つぎにそのテキストを解析して電子メールのオブジェクト構造を作成し、その構造を操作して、最後にオブジェクトツリーをフラットなテキストに戻す、という順序になっています。</p>
<p>このオブジェクト構造は、まったくのゼロから作りだしたものであってもいっこうにかまいません。この場合も上と似たような作業順序になるでしょう。</p>
<p>またここには <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージが提供するすべてのクラスおよびモジュールに関する説明と、 <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージを使っていくうえで遭遇するかもしれない例外クラス、いくつかの補助ユーティリティ、そして少々のサンプルも含まれています。古い <tt class="xref py py-mod docutils literal"><span class="pre">mimelib</span></tt> や前バージョンの <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージのユーザのために、現行バージョンとの違いと移植についての節も設けてあります。</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="email.message.html">18.1.1. <tt class="docutils literal"><span class="pre">email</span></tt>: 電子メールメッセージの表現</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.parser.html">18.1.2. <tt class="docutils literal"><span class="pre">email</span></tt>: 電子メールメッセージを解析(パース)する</a><ul>
<li class="toctree-l2"><a class="reference internal" href="email.parser.html#feedparser-api">18.1.2.1. FeedParser API</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.parser.html#parser-api">18.1.2.2. Parser クラス API</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.parser.html#id3">18.1.2.3. 追加事項</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="email.generator.html">18.1.3. <tt class="docutils literal"><span class="pre">email</span></tt>: MIME 文書を生成する</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.mime.html">18.1.4. <tt class="docutils literal"><span class="pre">email</span></tt>: 電子メールおよび MIME オブジェクトをゼロから作成する</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.header.html">18.1.5. <tt class="docutils literal"><span class="pre">email</span></tt>: 国際化されたヘッダ</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.charset.html">18.1.6. <tt class="docutils literal"><span class="pre">email</span></tt>: 文字セットの表現</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.encoders.html">18.1.7. <tt class="docutils literal"><span class="pre">email</span></tt>: エンコーダ</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.errors.html">18.1.8. <tt class="docutils literal"><span class="pre">email</span></tt>: 例外及び障害クラス</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.util.html">18.1.9. <tt class="docutils literal"><span class="pre">email</span></tt>: 雑用ユーティリティ</a></li>
<li class="toctree-l1"><a class="reference internal" href="email.iterators.html">18.1.10. <tt class="docutils literal"><span class="pre">email</span></tt>: イテレータ</a></li>
<li class="toctree-l1"><a class="reference internal" href="email-examples.html">18.1.11. <tt class="docutils literal"><span class="pre">email</span></tt>: 使用例</a></li>
</ul>
</div>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt>Module <a class="reference internal" href="smtplib.html#module-smtplib" title="smtplib: SMTP プロトコルクライアント (ソケットが必要です)。"><tt class="xref py py-mod docutils literal"><span class="pre">smtplib</span></tt></a></dt>
<dd>SMTP プロトコルクライアント</dd>
<dt>Module <a class="reference internal" href="nntplib.html#module-nntplib" title="nntplib: NNTP プロトコルクライアント (ソケットを必要とします)。"><tt class="xref py py-mod docutils literal"><span class="pre">nntplib</span></tt></a></dt>
<dd>NNTP プロトコルクライアント</dd>
</dl>
</div>
<div class="section" id="email-pkg-history">
<span id="id1"></span><h2>18.1.12. パッケージの履歴<a class="headerlink" href="#email-pkg-history" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>このテーブルは email パッケージのリリース履歴を表しています。それぞれのバージョンと、それが同梱された Python のバージョンとの関連が示されています。このドキュメントでの、追加/変更されたバージョンの表記は email パッケージのバージョン
<em>ではなく</em> 、Pythonのバージョンです。このテーブルは Python の各バージョン間の email パッケージの互換性も示しています。</p>
<table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="41%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">email バージョン</th>
<th class="head">配布</th>
<th class="head">互換</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><tt class="xref py py-const docutils literal"><span class="pre">1.x</span></tt></td>
<td>Python 2.2.0 to Python 2.2.1</td>
<td><em>もうサポートされません</em></td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-const docutils literal"><span class="pre">2.5</span></tt></td>
<td>Python 2.2.2+ and Python 2.3</td>
<td>Python 2.1 から 2.5</td>
</tr>
<tr class="row-even"><td><tt class="xref py py-const docutils literal"><span class="pre">3.0</span></tt></td>
<td>Python 2.4</td>
<td>Python 2.3 から 2.5</td>
</tr>
<tr class="row-odd"><td><tt class="xref py py-const docutils literal"><span class="pre">4.0</span></tt></td>
<td>Python 2.5</td>
<td>Python 2.3 から 2.5</td>
</tr>
</tbody>
</table>
<p>以下は <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> バージョン4と3の間のおもな差分です。</p>
<ul>
<li><p class="first">全モジュールが <span class="target" id="index-7"></span><a class="pep reference external" href="http://www.python.org/dev/peps/pep-0008"><strong>PEP 8</strong></a> 標準にあわせてリネームされました。たとえば、version 3 でのモジュール <tt class="xref py py-mod docutils literal"><span class="pre">email.Message</span></tt> は
version 4 では <a class="reference internal" href="email.message.html#module-email.message" title="email.message: 電子メールのメッセージを表現する基底クラス"><tt class="xref py py-mod docutils literal"><span class="pre">email.message</span></tt></a> になりました。</p>
</li>
<li><p class="first">新しいサブパッケージ <a class="reference internal" href="email.mime.html#module-email.mime" title="email.mime: MIME メッセージを作成する"><tt class="xref py py-mod docutils literal"><span class="pre">email.mime</span></tt></a> が追加され、
version 3 の <tt class="xref py py-mod docutils literal"><span class="pre">email.MIME*</span></tt> は、
<a class="reference internal" href="email.mime.html#module-email.mime" title="email.mime: MIME メッセージを作成する"><tt class="xref py py-mod docutils literal"><span class="pre">email.mime</span></tt></a> のサブパッケージにまとめられました。たとえば、version 3 での <tt class="xref py py-mod docutils literal"><span class="pre">email.MIMEText</span></tt> は、
<tt class="xref py py-mod docutils literal"><span class="pre">email.mime.text</span></tt> になりました。</p>
<p><em>Python 2.6までは version 3 の名前も有効です。</em></p>
</li>
<li><p class="first"><tt class="xref py py-mod docutils literal"><span class="pre">email.mime.application</span></tt> モジュールが追加されました。これは
<tt class="xref py py-class docutils literal"><span class="pre">MIMEApplication</span></tt> クラスを含んでいます。</p>
</li>
<li><p class="first">version 3 で推奨されないとされた機能は削除されました。これらは <tt class="xref py py-meth docutils literal"><span class="pre">Generator.__call__()</span></tt>,
<tt class="xref py py-meth docutils literal"><span class="pre">Message.get_type()</span></tt>, <tt class="xref py py-meth docutils literal"><span class="pre">Message.get_main_type()</span></tt>,
<tt class="xref py py-meth docutils literal"><span class="pre">Message.get_subtype()</span></tt> を含みます。</p>
</li>
<li><p class="first"><span class="target" id="index-8"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2331.html"><strong>RFC 2331</strong></a> サポートの修正が追加されました。これは <tt class="xref py py-func docutils literal"><span class="pre">Message.get_param()</span></tt> などの関数の返り値を変更します。いくつかの環境では、3つ組のタプルで返されていた値が1つの文字列で返されます
(とくに、全ての拡張パラメータセグメントがエンコードされていなかった場合、予測されていた language や charset の指定がないと、返り値は単純な文字列になります)。過去の版では % デコードがエンコードされているセグメントおよびエンコードされていないセグメントに対して行われましたが、エンコードされたセグメントのみで行われるようになりました。</p>
</li>
</ul>
<p><a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> バージョン 3 とバージョン 2 との違いは以下のようなものです:</p>
<ul class="simple">
<li><tt class="xref py py-class docutils literal"><span class="pre">FeedParser</span></tt> クラスが新しく導入され、 <tt class="xref py py-class docutils literal"><span class="pre">Parser</span></tt> クラスは <tt class="xref py py-class docutils literal"><span class="pre">FeedParser</span></tt>
を使って実装されるようになりました。このパーザは non-strict なものであり、解析はベストエフォート方式でおこなわれ解析中に例外を発生させることはありません。解析中に発見された問題はそのメッセージの <em>defect</em> (障害) 属性に保存されます。</li>
<li>バージョン 2 で <a class="reference internal" href="exceptions.html#exceptions.DeprecationWarning" title="exceptions.DeprecationWarning"><tt class="xref py py-exc docutils literal"><span class="pre">DeprecationWarning</span></tt></a> を発生していた API はすべて撤去されました。以下のものが含まれています:
<tt class="xref py py-class docutils literal"><span class="pre">MIMEText</span></tt> コンストラクタに渡す引数 <em>_encoder</em> 、
<tt class="xref py py-meth docutils literal"><span class="pre">Message.add_payload()</span></tt> メソッド、
<tt class="xref py py-func docutils literal"><span class="pre">Utils.dump_address_pair()</span></tt> 関数、そして <tt class="xref py py-func docutils literal"><span class="pre">Utils.decode()</span></tt> と
<tt class="xref py py-func docutils literal"><span class="pre">Utils.encode()</span></tt> です。</li>
<li>新しく以下の関数が <a class="reference internal" href="exceptions.html#exceptions.DeprecationWarning" title="exceptions.DeprecationWarning"><tt class="xref py py-exc docutils literal"><span class="pre">DeprecationWarning</span></tt></a> を発生するようになりました:
<tt class="xref py py-meth docutils literal"><span class="pre">Generator.__call__()</span></tt>,
<tt class="xref py py-meth docutils literal"><span class="pre">Message.get_type()</span></tt>, <tt class="xref py py-meth docutils literal"><span class="pre">Message.get_main_type()</span></tt>,
<tt class="xref py py-meth docutils literal"><span class="pre">Message.get_subtype()</span></tt>, そして <tt class="xref py py-class docutils literal"><span class="pre">Parser</span></tt> クラスに対する
<em>strict</em> 引数です。これらは email の将来のバージョンで撤去される予定です。</li>
<li>Python 2.3 以前はサポートされなくなりました。</li>
</ul>
<p><a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> バージョン 2 とバージョン 1 との違いは以下のようなものです:</p>
<ul>
<li><p class="first"><tt class="xref py py-mod docutils literal"><span class="pre">email.Header</span></tt> モジュールおよび <tt class="xref py py-mod docutils literal"><span class="pre">email.Charset</span></tt> モジュールが追加されています。</p>
</li>
<li><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> インスタンスの Pickle 形式が変わりました。が、これは正式に定義されたことは一度もないので (そしてこれからも)、この変更は互換性の欠如とはみなされていません。ですがもしお使いのアプリケーションが <tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> インスタンスを pickle あるいは
unpickle しているなら、現在 <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> バージョン 2 ではプライベート変数 <em>_charset</em> および
<em>_default_type</em> を含むようになったということに注意してください。</p>
</li>
<li><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> クラス中のいくつかのメソッドは推奨されなくなったか、あるいは呼び出し形式が変更になっています。また、多くの新しいメソッドが追加されています。詳しくは <tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> クラスの文書を参照してください。これらの変更は完全に下位互換になっているはずです。</p>
</li>
<li><p class="first"><em class="mimetype">message/rfc822</em> 形式のコンテナは、見た目上のオブジェクト構造が変わりました。
<a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> バージョン 1 ではこの content type はスカラー形式のペイロードとして表現されていました。つまり、コンテナメッセージの
<tt class="xref py py-meth docutils literal"><span class="pre">is_multipart()</span></tt> は false を返し、
<tt class="xref py py-meth docutils literal"><span class="pre">get_payload()</span></tt> はリストオブジェクトではなく単一の
<tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> インスタンスを直接返すようになっていたのです。</p>
<p>この構造はパッケージ中のほかの部分と整合がとれていなかったため、
<em class="mimetype">message/rfc822</em> 形式のオブジェクト表現形式が変更されました。 <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> バージョン 2 では、コンテナは
<tt class="xref py py-meth docutils literal"><span class="pre">is_multipart()</span></tt> に <em>True を返し</em> ます。また
<tt class="xref py py-meth docutils literal"><span class="pre">get_payload()</span></tt> はひとつの <tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> インスタンスを要素とするリストを返すようになりました。</p>
<p>注意: ここは下位互換が完全には成りたたなくなっている部分のひとつです。けれどもあらかじめ <tt class="xref py py-meth docutils literal"><span class="pre">get_payload()</span></tt> が返すタイプをチェックするようになっていれば問題にはなりません。ただ <em class="mimetype">message/rfc822</em> 形式のコンテナを
<tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> インスタンスにじかに <tt class="xref py py-meth docutils literal"><span class="pre">set_payload()</span></tt>
しないようにさえすればよいのです。</p>
</li>
<li><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">Parser</span></tt> コンストラクタに <em>strict</em> 引数が追加され、
<tt class="xref py py-meth docutils literal"><span class="pre">parse()</span></tt> および <tt class="xref py py-meth docutils literal"><span class="pre">parsestr()</span></tt>
メソッドには <em>headersonly</em> 引数がつきました。
<em>strict</em> フラグはまた <a class="reference internal" href="email.parser.html#email.message_from_file" title="email.message_from_file"><tt class="xref py py-func docutils literal"><span class="pre">email.message_from_file()</span></tt></a> と
<a class="reference internal" href="email.parser.html#email.message_from_string" title="email.message_from_string"><tt class="xref py py-func docutils literal"><span class="pre">email.message_from_string()</span></tt></a> にも追加されています。</p>
</li>
<li><p class="first"><tt class="xref py py-meth docutils literal"><span class="pre">Generator.__call__()</span></tt> はもはや推奨されなくなりました。かわりに <tt class="xref py py-meth docutils literal"><span class="pre">Generator.flatten()</span></tt> を使ってください。また、
<tt class="xref py py-class docutils literal"><span class="pre">Generator</span></tt> クラスには <tt class="xref py py-meth docutils literal"><span class="pre">clone()</span></tt> メソッドが追加されています。</p>
</li>
<li><p class="first"><a class="reference internal" href="email.generator.html#module-email.generator" title="email.generator: メッセージ構造からフラットな電子メールテキストを生成する。"><tt class="xref py py-mod docutils literal"><span class="pre">email.generator</span></tt></a> モジュールに <tt class="xref py py-class docutils literal"><span class="pre">DecodedGenerator</span></tt> クラスが加わりました。</p>
</li>
<li><p class="first">中間的な基底クラスである <tt class="xref py py-class docutils literal"><span class="pre">MIMENonMultipart</span></tt> および <tt class="xref py py-class docutils literal"><span class="pre">MIMEMultipart</span></tt>
がクラス階層の中に追加され、ほとんどの MIME 関係の派生クラスがこれを介するようになっています。</p>
</li>
<li><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">MIMEText</span></tt> コンストラクタの <em>_encoder</em> 引数は推奨されなくなりました。いまやエンコーダは <em>_charset</em> 引数にもとづいて暗黙のうちに決定されます。</p>
</li>
<li><p class="first"><a class="reference internal" href="email.util.html#module-email.utils" title="email.utils: 電子メールパッケージの雑多なユーティリティ。"><tt class="xref py py-mod docutils literal"><span class="pre">email.utils</span></tt></a> モジュールにおける以下の関数は推奨されなくなりました:
<tt class="xref py py-func docutils literal"><span class="pre">dump_address_pairs()</span></tt>, <tt class="xref py py-func docutils literal"><span class="pre">decode()</span></tt>, および <tt class="xref py py-func docutils literal"><span class="pre">encode()</span></tt> 。また、このモジュールには以下の関数が追加されています:
<tt class="xref py py-func docutils literal"><span class="pre">make_msgid()</span></tt>, <tt class="xref py py-func docutils literal"><span class="pre">decode_rfc2231()</span></tt>, <tt class="xref py py-func docutils literal"><span class="pre">encode_rfc2231()</span></tt> そして
<tt class="xref py py-func docutils literal"><span class="pre">decode_params()</span></tt> 。</p>
</li>
<li><p class="first">Public ではない関数 <a class="reference internal" href="email.iterators.html#email.iterators._structure" title="email.iterators._structure"><tt class="xref py py-func docutils literal"><span class="pre">email.iterators._structure()</span></tt></a> が追加されました。</p>
</li>
</ul>
</div>
<div class="section" id="mimelib">
<h2>18.1.13. <tt class="xref py py-mod docutils literal"><span class="pre">mimelib</span></tt> との違い<a class="headerlink" href="#mimelib" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージはもともと <a class="reference external" href="http://mimelib.sf.net/">mimelib</a> と呼ばれる個別のライブラリからつくられたものです。その後変更が加えられ、メソッド名がより一貫したものになり、いくつかのメソッドやモジュールが加えられたりはずされたりしました。いくつかのメソッドでは、その意味も変更されています。しかしほとんどの部分において、 <tt class="xref py py-mod docutils literal"><span class="pre">mimelib</span></tt>
パッケージで使うことのできた機能は、ときどきその方法が変わってはいるものの
<a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージでも使用可能です。 <tt class="xref py py-mod docutils literal"><span class="pre">mimelib</span></tt>
パッケージと <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージの間の下位互換性はあまり優先はされませんでした。</p>
<p>以下では <tt class="xref py py-mod docutils literal"><span class="pre">mimelib</span></tt> パッケージと <a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> パッケージにおける違いを簡単に説明し、それに沿ってアプリケーションを移植するさいの指針を述べています。</p>
<p>おそらく 2つのパッケージのもっとも明らかな違いは、パッケージ名が
<a class="reference internal" href="#module-email" title="email: 電子メールのメッセージを解析、操作および生成を支援するパッケージ。 これには MIME 文書もふくまれる。"><tt class="xref py py-mod docutils literal"><span class="pre">email</span></tt></a> に変更されたことでしょう。さらにトップレベルのパッケージが以下のように変更されました:</p>
<ul class="simple">
<li><tt class="xref py py-func docutils literal"><span class="pre">messageFromString()</span></tt> は <a class="reference internal" href="email.parser.html#email.message_from_string" title="email.message_from_string"><tt class="xref py py-func docutils literal"><span class="pre">message_from_string()</span></tt></a> に名前が変更されました。</li>
<li><tt class="xref py py-func docutils literal"><span class="pre">messageFromFile()</span></tt> は <a class="reference internal" href="email.parser.html#email.message_from_file" title="email.message_from_file"><tt class="xref py py-func docutils literal"><span class="pre">message_from_file()</span></tt></a> に名前が変更されました。</li>
</ul>
<p><tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> クラスでは、以下のような違いがあります:</p>
<ul class="simple">
<li><tt class="xref py py-meth docutils literal"><span class="pre">asString()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">as_string()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">ismultipart()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">is_multipart()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">get_payload()</span></tt> メソッドはオプション引数として <em>decode</em> をとるようになりました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getall()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_all()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">addheader()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">add_header()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">gettype()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_type()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getmaintype()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_main_type()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getsubtype()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_subtype()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getparams()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_params()</span></tt> に名前が変更されました。また、従来の <tt class="xref py py-meth docutils literal"><span class="pre">getparams()</span></tt> は文字列のリストを返していましたが、
<tt class="xref py py-meth docutils literal"><span class="pre">get_params()</span></tt> は 2-タプルのリストを返すようになっています。これはそのパラメータのキーと値の組が、 <tt class="docutils literal"><span class="pre">'='</span></tt> 記号によって分離されたものです。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getparam()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_param()</span></tt>.</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getcharsets()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_charsets()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getfilename()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_filename()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getboundary()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">get_boundary()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">setboundary()</span></tt> メソッドは <tt class="xref py py-meth docutils literal"><span class="pre">set_boundary()</span></tt> に名前が変更されました。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getdecodedpayload()</span></tt> メソッドは廃止されました。これと同様の機能は <tt class="xref py py-meth docutils literal"><span class="pre">get_payload()</span></tt> メソッドの
<em>decode</em> フラグに 1 を渡すことで実現できます。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getpayloadastext()</span></tt> メソッドは廃止されました。これと同様の機能は <tt class="xref py py-mod docutils literal"><span class="pre">email.Generator</span></tt> モジュールの
<tt class="xref py py-class docutils literal"><span class="pre">DecodedGenerator</span></tt> クラスによって提供されます。</li>
<li><tt class="xref py py-meth docutils literal"><span class="pre">getbodyastext()</span></tt> メソッドは廃止されました。これと同様の機能は <a class="reference internal" href="email.iterators.html#module-email.iterators" title="email.iterators: メッセージオブジェクトツリーをたどる。"><tt class="xref py py-mod docutils literal"><span class="pre">email.iterators</span></tt></a> モジュールにある
<tt class="xref py py-func docutils literal"><span class="pre">typed_subpart_iterator()</span></tt> を使ってイテレータを作ることにより実現できます。</li>
</ul>
<p><tt class="xref py py-class docutils literal"><span class="pre">Parser</span></tt> クラスは、その public なインターフェイスは変わっていませんが、これはより一層かしこくなって <em class="mimetype">message/delivery-status</em> 形式のメッセージを認識するようになりました。これは配送状態通知  <a class="footnote-reference" href="#id4" id="id3">[1]</a>
において、各ヘッダブロックを表す独立した <tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> パートを含むひとつの <tt class="xref py py-class docutils literal"><span class="pre">Message</span></tt> インスタンスとして表現されます。</p>
<p><tt class="xref py py-class docutils literal"><span class="pre">Generator</span></tt> クラスは、その public なインターフェイスは変わっていませんが、
<a class="reference internal" href="email.generator.html#module-email.generator" title="email.generator: メッセージ構造からフラットな電子メールテキストを生成する。"><tt class="xref py py-mod docutils literal"><span class="pre">email.generator</span></tt></a> モジュールに新しいクラスが加わりました。
<tt class="xref py py-class docutils literal"><span class="pre">DecodedGenerator</span></tt> と呼ばれるこのクラスは以前
<tt class="xref py py-meth docutils literal"><span class="pre">Message.getpayloadastext()</span></tt> メソッドで使われていた機能のほとんどを提供します。</p>
<p>また、以下のモジュールおよびクラスが変更されています:</p>
<ul>
<li><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">MIMEBase</span></tt> クラスのコンストラクタ引数 <em>_major</em> と <em>_minor</em> は、それぞれ <em>_maintype</em> と <em>_subtype</em> に変更されています。</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Image</span></tt> クラスおよびモジュールは <tt class="docutils literal"><span class="pre">MIMEImage</span></tt> に名前が変更されました。
<em>_minor</em> 引数も <em>_subtype</em> に名前が変更されています。</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Text</span></tt> クラスおよびモジュールは <tt class="docutils literal"><span class="pre">MIMEText</span></tt> に名前が変更されました。
<em>_minor</em> 引数も <em>_subtype</em> に名前が変更されています。</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">MessageRFC822</span></tt> クラスおよびモジュールは <tt class="docutils literal"><span class="pre">MIMEMessage</span></tt> に名前が変更されました。注意: 従来バージョンの <tt class="xref py py-mod docutils literal"><span class="pre">mimelib</span></tt> では、このクラスおよびモジュールは
<tt class="docutils literal"><span class="pre">RFC822</span></tt> という名前でしたが、これは大文字小文字を区別しないファイルシステムでは
Python の標準ライブラリモジュール <a class="reference internal" href="rfc822.html#module-rfc822" title="rfc822: RFC 2822 形式のメールメッセージを解釈します。 (撤廃)"><tt class="xref py py-mod docutils literal"><span class="pre">rfc822</span></tt></a> と名前がかち合ってしまっていました。</p>
<p>また、 <tt class="xref py py-class docutils literal"><span class="pre">MIMEMessage</span></tt> クラスはいまや <em class="mimetype">message</em>
main type をもつあらゆる種類の MIME メッセージを表現できるようになりました。これはオプション引数として、MIME subtype を指定する <em>_subtype</em> 引数をとることができるようになっています。デフォルトでは、 <em>_subtype</em> は <em class="mimetype">rfc822</em> になります。</p>
</li>
</ul>
<p><tt class="xref py py-mod docutils literal"><span class="pre">mimelib</span></tt> では、 <tt class="xref py py-mod docutils literal"><span class="pre">address</span></tt> および <tt class="xref py py-mod docutils literal"><span class="pre">date</span></tt> モジュールでいくつかのユーティリティ関数が提供されていました。これらの関数はすべて
<a class="reference internal" href="email.util.html#module-email.utils" title="email.utils: 電子メールパッケージの雑多なユーティリティ。"><tt class="xref py py-mod docutils literal"><span class="pre">email.utils</span></tt></a> モジュールの中に移されています。</p>
<p><tt class="docutils literal"><span class="pre">MsgReader</span></tt> クラスおよびモジュールは廃止されました。これにもっとも近い機能は <a class="reference internal" href="email.iterators.html#module-email.iterators" title="email.iterators: メッセージオブジェクトツリーをたどる。"><tt class="xref py py-mod docutils literal"><span class="pre">email.iterators</span></tt></a> モジュール中の
<tt class="xref py py-func docutils literal"><span class="pre">body_line_iterator()</span></tt> 関数によって提供されています。</p>
<p class="rubric">注記</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[1]</a></td><td>配送状態通知 (Delivery Status Notifications, DSN) は <span class="target" id="index-9"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc1894.html"><strong>RFC 1894</strong></a> によって定義されています。</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="email.message.html" title="18.1.1. email: 電子メールメッセージの表現"
             >次へ</a> |</li>
        <li class="right" >
          <a href="netdata.html" title="18. インターネット上のデータの操作"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" >Python 標準ライブラリ</a> &raquo;</li>
          <li><a href="netdata.html" >18. インターネット上のデータの操作</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 1990-2011, Python Software Foundation.
      最終更新: 2011-12-26
      このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/02cb752c6a9e で生成しました。
    </div>
  </body>
</html>