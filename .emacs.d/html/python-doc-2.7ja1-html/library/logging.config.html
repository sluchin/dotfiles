

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>15.8. logging.config — ロギングの環境設定 &mdash; Python 2.7ja1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.7ja1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 2.7ja1 documentation 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="Python 2.7ja1 documentation" href="../index.html" />
    <link rel="up" title="15. 汎用オペレーティングシステムサービス" href="allos.html" />
    <link rel="next" title="15.9. logging.handlers — ロギングハンドラ" href="logging.handlers.html" />
    <link rel="prev" title="15.7. logging — Python 用ロギング機能" href="logging.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/_jp.js"></script>
    
 

  </head>
  <body>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="logging.handlers.html" title="15.9. logging.handlers — ロギングハンドラ"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="logging.html" title="15.7. logging — Python 用ロギング機能"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" >Python 標準ライブラリ</a> &raquo;</li>
          <li><a href="allos.html" accesskey="U">15. 汎用オペレーティングシステムサービス</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">15.8. <tt class="docutils literal"><span class="pre">logging.config</span></tt> &#8212; ロギングの環境設定</a><ul>
<li><a class="reference internal" href="#logging-config-api">15.8.1. 環境設定のための関数</a></li>
<li><a class="reference internal" href="#logging-config-dictschema">15.8.2. 環境設定辞書スキーマ</a><ul>
<li><a class="reference internal" href="#id3">15.8.2.1. 辞書スキーマの詳細</a></li>
<li><a class="reference internal" href="#logging-config-dict-incremental">15.8.2.2. 増分設定</a></li>
<li><a class="reference internal" href="#logging-config-dict-connections">15.8.2.3. オブジェクトの接続</a></li>
<li><a class="reference internal" href="#logging-config-dict-userdef">15.8.2.4. ユーザ定義オブジェクト</a></li>
<li><a class="reference internal" href="#logging-config-dict-externalobj">15.8.2.5. 外部オブジェクトへのアクセス</a></li>
<li><a class="reference internal" href="#logging-config-dict-internalobj">15.8.2.6. 内部オブジェクトへのアクセス</a></li>
</ul>
</li>
<li><a class="reference internal" href="#logging-config-fileformat">15.8.3. 環境設定ファイルの書式</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="logging.html"
                        title="前の章へ">15.7. <tt class="docutils literal docutils literal docutils literal"><span class="pre">logging</span></tt> &#8212; Python 用ロギング機能</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="logging.handlers.html"
                        title="次の章へ">15.9. <tt class="docutils literal docutils literal"><span class="pre">logging.handlers</span></tt> &#8212; ロギングハンドラ</a></p>
  <h3>このページ</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/library/logging.config.txt"
           rel="nofollow">ソースコードを表示</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-logging.config">
<span id="logging-config"></span><h1>15.8. <a class="reference internal" href="#module-logging.config" title="logging.config: logging モジュールの環境設定"><tt class="xref py py-mod docutils literal"><span class="pre">logging.config</span></tt></a> &#8212; ロギングの環境設定<a class="headerlink" href="#module-logging.config" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="sidebar">
<p class="first sidebar-title">Important</p>
<p>このページには、リファレンス情報だけが含まれています。チュートリアルは、以下のページを参照してください</p>
<ul class="last simple">
<li><a class="reference internal" href="../howto/logging.html#logging-basic-tutorial"><em>基本チュートリアル</em></a></li>
<li><a class="reference internal" href="../howto/logging.html#logging-advanced-tutorial"><em>上級チュートリアル</em></a></li>
<li><a class="reference internal" href="../howto/logging-cookbook.html#logging-cookbook"><em>ロギングクックブック</em></a></li>
</ul>
</div>
<p>この節は、 logging モジュールを設定するための API を解説します。</p>
<div class="section" id="logging-config-api">
<span id="id1"></span><h2>15.8.1. 環境設定のための関数<a class="headerlink" href="#logging-config-api" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>以下の関数は logging モジュールの環境設定をします。これらの関数は、 <a class="reference internal" href="#module-logging.config" title="logging.config: logging モジュールの環境設定"><tt class="xref py py-mod docutils literal"><span class="pre">logging.config</span></tt></a> にあります。これらの関数の使用はオプションです &#8212;
<a class="reference internal" href="logging.html#module-logging" title="logging: アプリケーションのための、柔軟なエラーロギングシステム"><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a> モジュールはこれらの関数を使うか、 (<a class="reference internal" href="logging.html#module-logging" title="logging: アプリケーションのための、柔軟なエラーロギングシステム"><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a> 自体で定義されている) 主要な API を呼び出し、 <a class="reference internal" href="logging.html#module-logging" title="logging: アプリケーションのための、柔軟なエラーロギングシステム"><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a> か
<a class="reference internal" href="logging.handlers.html#module-logging.handlers" title="logging.handlers: logging モジュールのためのハンドラ"><tt class="xref py py-mod docutils literal"><span class="pre">logging.handlers</span></tt></a> で宣言されているハンドラを定義することで設定できます。</p>
<dl class="function">
<dt id="logging.config.dictConfig">
<tt class="descclassname">logging.config.</tt><tt class="descname">dictConfig</tt><big>(</big><em>config</em><big>)</big><a class="headerlink" href="#logging.config.dictConfig" title="この定義へのパーマリンク">¶</a></dt>
<dd><blockquote>
<div><p>辞書からロギング環境設定を取得します。この辞書の内容は、以下の
<a class="reference internal" href="#logging-config-dictschema"><em>環境設定辞書スキーマ</em></a> で記述されています。</p>
<p>環境設定中にエラーに遭遇すると、この関数は適宜メッセージを記述しつつ
<a class="reference internal" href="exceptions.html#exceptions.ValueError" title="exceptions.ValueError"><tt class="xref py py-exc docutils literal"><span class="pre">ValueError</span></tt></a>, <a class="reference internal" href="exceptions.html#exceptions.TypeError" title="exceptions.TypeError"><tt class="xref py py-exc docutils literal"><span class="pre">TypeError</span></tt></a>, <a class="reference internal" href="exceptions.html#exceptions.AttributeError" title="exceptions.AttributeError"><tt class="xref py py-exc docutils literal"><span class="pre">AttributeError</span></tt></a> または
<a class="reference internal" href="exceptions.html#exceptions.ImportError" title="exceptions.ImportError"><tt class="xref py py-exc docutils literal"><span class="pre">ImportError</span></tt></a> を送出します。例外を送出する条件を (不完全かもしれませんが) 以下に列挙します:</p>
<ul class="simple">
<li>文字列でなかったり、実際のロギングレベルと関係ない文字列であったりする
<tt class="docutils literal"><span class="pre">level</span></tt></li>
<li>ブール値でない <tt class="docutils literal"><span class="pre">propagate</span></tt> の値</li>
<li>対応する行き先を持たない id</li>
<li>インクリメンタルな呼び出しの中で見つかった存在しないハンドラ id</li>
<li>無効なロガー名</li>
<li>内部や外部のオブジェクトに関わる不可能性</li>
</ul>
<p>解析は <tt class="xref py py-class docutils literal"><span class="pre">DictConfigurator</span></tt> クラスによって行われます。このクラスのコンストラクタは環境設定に使われる辞書に渡され、このクラスは
<tt class="xref py py-meth docutils literal"><span class="pre">configure()</span></tt> メソッドを持ちます。 <a class="reference internal" href="#module-logging.config" title="logging.config: logging モジュールの環境設定"><tt class="xref py py-mod docutils literal"><span class="pre">logging.config</span></tt></a> モジュールは、呼び出し可能属性 <tt class="xref py py-attr docutils literal"><span class="pre">dictConfigClass</span></tt> を持ち、これはまず
<tt class="xref py py-class docutils literal"><span class="pre">DictConfigurator</span></tt> に設定されます。 <tt class="xref py py-attr docutils literal"><span class="pre">dictConfigClass</span></tt> の値は適切な独自の実装で置き換えられます。</p>
<p><a class="reference internal" href="#logging.config.dictConfig" title="logging.config.dictConfig"><tt class="xref py py-func docutils literal"><span class="pre">dictConfig()</span></tt></a> は <tt class="xref py py-attr docutils literal"><span class="pre">dictConfigClass</span></tt> を、指定された辞書を渡して呼び出し、それから返されたオブジェクトの <tt class="xref py py-meth docutils literal"><span class="pre">configure()</span></tt> メソッドを呼び出して、環境設定を作用させます:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">dictConfig</span><span class="p">(</span><span class="n">config</span><span class="p">):</span>
    <span class="n">dictConfigClass</span><span class="p">(</span><span class="n">config</span><span class="p">)</span><span class="o">.</span><span class="n">configure</span><span class="p">()</span>
</pre></div>
</div>
<p>例えば、 <tt class="xref py py-class docutils literal"><span class="pre">DictConfigurator</span></tt> のサブクラスは、自身の
<a class="reference internal" href="../reference/datamodel.html#object.__init__" title="object.__init__"><tt class="xref py py-meth docutils literal"><span class="pre">__init__()</span></tt></a> で <tt class="docutils literal"><span class="pre">DictConfigurator.__init__()</span></tt> を呼び出し、それから続く <tt class="xref py py-meth docutils literal"><span class="pre">configure()</span></tt> の呼び出しに使えるカスタムの接頭辞を設定できます。
<tt class="xref py py-attr docutils literal"><span class="pre">dictConfigClass</span></tt> は、この新しいサブクラスに束縛され、そして
<a class="reference internal" href="#logging.config.dictConfig" title="logging.config.dictConfig"><tt class="xref py py-func docutils literal"><span class="pre">dictConfig()</span></tt></a> はちょうどデフォルトの、カスタマイズされていない状態のように呼び出せます。</p>
</div></blockquote>
<p class="versionadded">
<span class="versionmodified">バージョン 2.7 で追加.</span></p>
</dd></dl>

<dl class="function">
<dt id="logging.config.fileConfig">
<tt class="descclassname">logging.config.</tt><tt class="descname">fileConfig</tt><big>(</big><em>fname</em>, <em>defaults=None</em>, <em>disable_existing_loggers=True</em><big>)</big><a class="headerlink" href="#logging.config.fileConfig" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ログ記録の環境設定をファイル名 <em>fname</em> の <tt class="xref py py-mod docutils literal"><span class="pre">configparser</span></tt> 形式ファイルから読み出します。この関数はアプリケーションから何度も呼び出すことができ、これによって、
(設定を選択し、選択された設定を読み出す機構をデベロッパが提供していれば)
複数の準備済みの設定からエンドユーザが選択するようにできます。</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">パラメタ:</th><td class="field-body"><ul class="first last simple">
<li><strong>defaults</strong> &#8211; ConfigParser に渡すためのデフォルト値はこの引数で指定できます。</li>
<li><strong>disable_existing_loggers</strong> &#8211; <tt class="docutils literal"><span class="pre">False</span></tt> に指定されると、この呼び出しがなされたときに存在するロガーはそのままにしておかれます。後方互換性を保って古い動作を行えるように、デフォルトは <tt class="docutils literal"><span class="pre">True</span></tt> です。この動作は、すべての既存のロガーを、ロギング環境設定でそれ自身かその祖先を明示的に指名されない限り、無効にします。</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="versionchanged">
<span class="versionmodified">バージョン 2.6 で変更: </span><tt class="docutils literal"><span class="pre">disable_existing_loggers</span></tt> キーワード引数が追加されました。
以前は、既存のロガーは <em>必ず</em> 無効にされていました。</p>
</dd></dl>

<dl class="function">
<dt id="logging.config.listen">
<tt class="descclassname">logging.config.</tt><tt class="descname">listen</tt><big>(</big><em>port=DEFAULT_LOGGING_CONFIG_PORT</em><big>)</big><a class="headerlink" href="#logging.config.listen" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定されたポートでソケットサーバを開始し、新たな設定を待ち受けます。ポートが指定されなければ、モジュールのデフォルトの
<tt class="xref py py-const docutils literal"><span class="pre">DEFAULT_LOGGING_CONFIG_PORT</span></tt> が使われます。ログ記録の環境設定は <a class="reference internal" href="#logging.config.fileConfig" title="logging.config.fileConfig"><tt class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></tt></a> で処理できるようなファイルとして送信されます。
<tt class="xref py py-class docutils literal"><span class="pre">Thread</span></tt> インスタンスを返し、サーバを開始するために <tt class="xref py py-meth docutils literal"><span class="pre">start()</span></tt> を呼び、適切な状況で <tt class="xref py py-meth docutils literal"><span class="pre">join()</span></tt> を呼び出すことができます。サーバを停止するには <a class="reference internal" href="#logging.config.stopListening" title="logging.config.stopListening"><tt class="xref py py-func docutils literal"><span class="pre">stopListening()</span></tt></a> を呼んでください。</p>
<p>ソケットに設定を送るには、まず設定ファイルを読み、それを
<tt class="docutils literal"><span class="pre">struct.pack('&gt;L',</span> <span class="pre">n)</span></tt> を使って長さ 4 バイトのバイナリにパックしたものを前に付けたバイト列としてソケットに送ります。</p>
</dd></dl>

<dl class="function">
<dt id="logging.config.stopListening">
<tt class="descclassname">logging.config.</tt><tt class="descname">stopListening</tt><big>(</big><big>)</big><a class="headerlink" href="#logging.config.stopListening" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#logging.config.listen" title="logging.config.listen"><tt class="xref py py-func docutils literal"><span class="pre">listen()</span></tt></a> を呼び出して作成された、待ち受け中のサーバを停止します。通常 <a class="reference internal" href="#logging.config.listen" title="logging.config.listen"><tt class="xref py py-func docutils literal"><span class="pre">listen()</span></tt></a> の戻り値に対して <tt class="xref py py-meth docutils literal"><span class="pre">join()</span></tt> が呼ばれる前に呼び出します。</p>
</dd></dl>

</div>
<div class="section" id="logging-config-dictschema">
<span id="id2"></span><h2>15.8.2. 環境設定辞書スキーマ<a class="headerlink" href="#logging-config-dictschema" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>ロギング設定を記述するには、生成するさまざまなオブジェクトと、それらのつながりを列挙しなければなりません。例えば、 &#8216;console&#8217; という名前のハンドラを生成し、&#8217;startup&#8217; という名前のロガーがメッセージを
&#8216;console&#8217; ハンドラに送るというようなことを記述します。これらのオブジェクトは、 <a class="reference internal" href="logging.html#module-logging" title="logging: アプリケーションのための、柔軟なエラーロギングシステム"><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a> モジュールによって提供されるものに限らず、独自のフォーマッタやハンドラクラスを書くことも出来ます。このクラスへのパラメタは、 <tt class="docutils literal"><span class="pre">sys.stderr</span></tt> のような外部オブジェクトを必要とすることもあります。これらのオブジェクトとつながりを記述する構文は、以下の <a class="reference internal" href="#logging-config-dict-connections"><em>オブジェクトの接続</em></a> で定義されています。</p>
<div class="section" id="id3">
<h3>15.8.2.1. 辞書スキーマの詳細<a class="headerlink" href="#id3" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><a class="reference internal" href="#logging.config.dictConfig" title="logging.config.dictConfig"><tt class="xref py py-func docutils literal"><span class="pre">dictConfig()</span></tt></a> に渡される辞書は、以下のキーを含んでいなければなりません:</p>
<ul class="simple">
<li><em>version</em> - スキーマのバージョンを表す整数値に設定されます。現在有効な値は 1 だけですが、このキーがあることで、このスキーマは後方互換性を保ちながら発展できます。</li>
</ul>
<p>その他すべてのキーは省略可能ですが、与えられたなら以下に記述するように解釈されます。以下のすべての場合において、
&#8216;環境設定辞書&#8217; と記載されている所では、その辞書に特殊な <tt class="docutils literal"><span class="pre">'()'</span></tt> キーがあるかを調べることで、カスタムのインスタント化が必要であるか判断されます。その場合は、以下の <a class="reference internal" href="#logging-config-dict-userdef"><em>ユーザ定義オブジェクト</em></a> で記述されている機構がインスタンス生成に使われます。そうでなければ、インスタンス化するべきものを決定するのにコンテキストが使われます。</p>
<ul>
<li><p class="first"><em>formatters</em> - 対応する値は辞書で、そのそれぞれのキーがフォーマッタ id になり、それぞれの値が対応する Formatter インスタンスをどのように環境設定するかを記述する辞書になります。</p>
<p>環境設定辞書は、(デフォルトが <tt class="docutils literal"><span class="pre">None</span></tt> の) キー <tt class="docutils literal"><span class="pre">format</span></tt> と <tt class="docutils literal"><span class="pre">datefmt</span></tt> を検索され、それらが <a class="reference internal" href="logging.html#logging.Formatter" title="logging.Formatter"><tt class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></tt></a> インスタンスを構成するのに使われます。</p>
</li>
<li><p class="first"><em>filters</em> - 対応する値は辞書で、そのそれぞれのキーがフィルタ id になり、それぞれの値が対応する Filter インスタンスをどのように環境設定するかを記述する辞書になります。</p>
<p>環境設定辞書は、(デフォルトが空文字列の) キー <tt class="docutils literal"><span class="pre">name</span></tt> を検索され、それらが <a class="reference internal" href="logging.html#logging.Formatter" title="logging.Formatter"><tt class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></tt></a> インスタンスを構成するのに使われます。</p>
</li>
<li><p class="first"><em>handlers</em> - 対応する値は辞書で、そのそれぞれのキーがハンドラ id になり、それぞれの値が対応する Handler インスタンスをどのように環境設定するかを記述する辞書になります。</p>
<p>環境設定辞書は、以下のキーを検索されます。</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">class</span></tt> (必須)。これはハンドラクラスの完全に修飾された名前です。</li>
<li><tt class="docutils literal"><span class="pre">level</span></tt> (任意)。ハンドラのレベルです。</li>
<li><tt class="docutils literal"><span class="pre">formatter</span></tt> (任意)。このハンドラへのフォーマッタの id です。</li>
<li><tt class="docutils literal"><span class="pre">filters</span></tt> (任意)。このハンドラへのフィルタの id のリストです。</li>
</ul>
<p>その他の <em>すべての</em> キーは、ハンドラのコンストラクタにキーワード引数として渡されます。例えば、以下のコード片が与えられたら:</p>
<div class="highlight-python"><pre>handlers:
  console:
    class : logging.StreamHandler
    formatter: brief
    level   : INFO
    filters: [allow_foo]
    stream  : ext://sys.stdout
  file:
    class : logging.handlers.RotatingFileHandler
    formatter: precise
    filename: logconfig.log
    maxBytes: 1024
    backupCount: 3</pre>
</div>
<p>id が <tt class="docutils literal"><span class="pre">console</span></tt> であるハンドラが、 <tt class="docutils literal"><span class="pre">sys.stdout</span></tt> を根底のストリームにして、 <a class="reference internal" href="logging.handlers.html#logging.StreamHandler" title="logging.StreamHandler"><tt class="xref py py-class docutils literal"><span class="pre">logging.StreamHandler</span></tt></a> としてインスタンス化されます。id が <tt class="docutils literal"><span class="pre">file</span></tt> であるハンドラが、
<tt class="docutils literal"><span class="pre">filename='logconfig.log',</span> <span class="pre">maxBytes=1024,</span> <span class="pre">backupCount=3</span></tt>
をキーワード引数にして、 <a class="reference internal" href="logging.handlers.html#logging.handlers.RotatingFileHandler" title="logging.handlers.RotatingFileHandler"><tt class="xref py py-class docutils literal"><span class="pre">logging.handlers.RotatingFileHandler</span></tt></a>
としてインスタンス化されます。</p>
</li>
<li><p class="first"><em>loggers</em> - 対応する値は辞書で、そのそれぞれのキーがロガー名になり、それぞれの値が対応する Logger インスタンスをどのように環境設定するかを記述する辞書になります。</p>
<p>環境設定辞書は、以下のキーを検索されます。</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">level</span></tt> (任意)。ロガーのレベルです。</li>
<li><tt class="docutils literal"><span class="pre">propagate</span></tt> (任意)。ロガーの伝播の設定です。</li>
<li><tt class="docutils literal"><span class="pre">filters</span></tt> (任意)。このロガーへのフィルタの id のリストです。</li>
<li><tt class="docutils literal"><span class="pre">filters</span></tt> (任意)。このロガーへのハンドラの id のリストです。</li>
</ul>
<p>指定されたロガーは、指定されたレベル、伝播、ハンドラに従って環境設定されます。</p>
</li>
<li><p class="first"><em>root</em> - これは、ルートロガーへの設定になります。この環境設定の進行は、 <tt class="docutils literal"><span class="pre">propagate</span></tt> 設定が適用されないことを除き、他のロガーと同じです。</p>
</li>
<li><p class="first"><em>incremental</em> - この環境設定が既存の環境設定に対する増分として解釈されるかどうかです。この値のデフォルトは <tt class="docutils literal"><span class="pre">False</span></tt> で、指定された環境設定は、既存の <a class="reference internal" href="#logging.config.fileConfig" title="logging.config.fileConfig"><tt class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></tt></a> API
によって使われているのと同じ意味上で、既存の環境設定を置き換えます。</p>
<p>指定された値が <tt class="docutils literal"><span class="pre">True</span></tt> なら、環境設定は
<a class="reference internal" href="#logging-config-dict-incremental"><em>増分設定</em></a> の節で記述されているように進行します。</p>
<p><em>disable_existing_loggers</em> - 既存のロガーをすべて無効にするべきかどうかです。この設定は、 <a class="reference internal" href="#logging.config.fileConfig" title="logging.config.fileConfig"><tt class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></tt></a> における同じ名前のパラメタと同じです。設定されていなければ、このパラメタのデフォルトは <tt class="docutils literal"><span class="pre">True</span></tt> です。この値は、 <em>incremental</em> が <tt class="docutils literal"><span class="pre">True</span></tt> なら無視されます。</p>
</li>
</ul>
</div>
<div class="section" id="logging-config-dict-incremental">
<span id="id4"></span><h3>15.8.2.2. 増分設定<a class="headerlink" href="#logging-config-dict-incremental" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>増分設定に完全な柔軟性を提供するのは難しいです。例えば、フィルタやフォーマッタのようなオブジェクトは匿名なので、一旦環境設定がなされると、設定を拡張するときにそのような匿名オブジェクトを参照することができません。</p>
<p>さらに、一旦環境設定がなされた後、実行時にロガー、ハンドラ、フィルタ、フォーマッタのオブジェクトグラフを任意に変えなければならない例もありません。ロガーとハンドラの冗長性は、レベル (または、ロガーの場合には、伝播フラグ) を設定することによってのみ制御できます。安全な方法でオブジェクトグラフを任意に変えることは、マルチスレッド環境で問題となります。不可能ではないですが、その効用は実装に加えられる複雑さに見合いません。</p>
<p>従って、環境設定辞書の <tt class="docutils literal"><span class="pre">incremental</span></tt> キーが与えられ、これが <tt class="docutils literal"><span class="pre">True</span></tt>
であるとき、システムは <tt class="docutils literal"><span class="pre">formatters</span></tt> と <tt class="docutils literal"><span class="pre">filters</span></tt> の項目を完全に無視し、
<tt class="docutils literal"><span class="pre">handlers</span></tt> の項目の <tt class="docutils literal"><span class="pre">level</span></tt> 設定と、 <tt class="docutils literal"><span class="pre">loggers</span></tt> と <tt class="docutils literal"><span class="pre">root</span></tt> の項目の
<tt class="docutils literal"><span class="pre">level</span></tt> と <tt class="docutils literal"><span class="pre">propagate</span></tt> 設定のみを処理します。</p>
<p>環境設定辞書の値を使うことで、設定は pickle 化された辞書としてソケットリスナにワイヤを通して送ることができます。従って、時間のかかるアプリケーションのロギングの冗長性は、アプリケーションを止めて再起動する必要がない時間に変えることができます。</p>
</div>
<div class="section" id="logging-config-dict-connections">
<span id="id5"></span><h3>15.8.2.3. オブジェクトの接続<a class="headerlink" href="#logging-config-dict-connections" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>このスキーマは、ロギングオブジェクトの一揃い - ロガー、ハンドラ、フォーマッタ、フィルタ - について記述します。これらは、オブジェクトグラフ上でお互い接続されます。従って、このスキーマは、オブジェクト間の接続を表現しなければなりません。例えば、環境設定で、特定のロガーが特定のハンドラに取り付けられたとします。この議論では、ロガーとハンドラが、これら 2 つの接続のそれぞれ送信元と送信先であるといえます。もちろん、この設定オブジェクト中では、これはハンドラへの参照を保持しているロガーで表されます。設定辞書中で、これは次のようになされます。まず、送信先オブジェクトを曖昧さなく指定する id を与えます。そして、その id を送信元オブジェクトの環境設定で使い、送信元とその id をもつ送信先が接続されていることを示します。</p>
<p>ですから、例えば、以下の YAML のコード片を例にとると:</p>
<div class="highlight-python"><pre>formatters:
  brief:
    # configuration for formatter with id 'brief' goes here
  precise:
    # configuration for formatter with id 'precise' goes here
handlers:
  h1: #This is an id
   # configuration of handler with id 'h1' goes here
   formatter: brief
  h2: #This is another id
   # configuration of handler with id 'h2' goes here
   formatter: precise
loggers:
  foo.bar.baz:
    # other configuration for logger 'foo.bar.baz'
    handlers: [h1, h2]</pre>
</div>
<p>(注釈: YAML がここで使われているのは、辞書の等価な Python 形式よりもこちらのほうが少し読みやすいからです。)</p>
<p>ロガーの id は、プログラム上でロガーへの参照を得るために使われるロガー名で、たとえば <tt class="docutils literal"><span class="pre">foo.bar.baz</span></tt> です。フォーマッタとフィルタの id は、
(上の <tt class="docutils literal"><span class="pre">brief</span></tt>, <tt class="docutils literal"><span class="pre">precise</span></tt> のような) 任意の文字列値にできます。これらは一時的なもので、環境設定辞書の処理にのみ意味があり、オブジェクト間の接続を決定するのに使われます。また、これらは設定の呼び出しが完了したとき、どこにも残りません。</p>
<p>上記のコード片は、 <tt class="docutils literal"><span class="pre">foo.bar.baz</span></tt>  というの名ロガーに、ハンドラ id <tt class="docutils literal"><span class="pre">h1</span></tt> と
<tt class="docutils literal"><span class="pre">h2</span></tt> で表される 2 つのハンドラを接続することを示します。
<tt class="docutils literal"><span class="pre">h1</span></tt> のフォーマッタは id <tt class="docutils literal"><span class="pre">brief</span></tt> で記述されるもので、
<tt class="docutils literal"><span class="pre">h2</span></tt> のフォーマッタは id <tt class="docutils literal"><span class="pre">precise</span></tt> で記述されるものです。</p>
</div>
<div class="section" id="logging-config-dict-userdef">
<span id="id6"></span><h3>15.8.2.4. ユーザ定義オブジェクト<a class="headerlink" href="#logging-config-dict-userdef" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>このスキーマは、ハンドラ、フィルタ、フォーマッタのための、ユーザ定義オブジェクトをサポートします。
(ロガーは、異なるインスタンスに対して異なる型を持つ必要はないので、この環境設定スキーマは、ユーザ定義ロガークラスをサポートしていません。)</p>
<p>設定されるオブジェクトは、それらの設定を詳述する辞書によって記述されます。場所によっては、あるオブジェクトがどのようにインスタンス化されるかというコンテキストを、ロギングシステムが推測できます。しかし、ユーザ定義オブジェクトがインスタンス化されるとき、システムはどのようにこれを行うかを知りません。ユーザ定義オブジェクトのインスタンス化を完全に柔軟なものにするため、ユーザは &#8216;ファクトリ&#8217; - 設定辞書を引数として呼ばれ、インスタンス化されたオブジェクトを返す呼び出し可能オブジェクト - を提供する必要があります。これは特殊キー <tt class="docutils literal"><span class="pre">'()'</span></tt> で利用できる、ファクトリへの絶対インポートパスによって合図されます。ここに具体的な例を挙げます:</p>
<div class="highlight-python"><pre>formatters:
  brief:
    format: '%(message)s'
  default:
    format: '%(asctime)s %(levelname)-8s %(name)-15s %(message)s'
    datefmt: '%Y-%m-%d %H:%M:%S'
  custom:
      (): my.package.customFormatterFactory
      bar: baz
      spam: 99.9
      answer: 42</pre>
</div>
<p>上記の YAML コード片は 3 つのフォーマッタを定義します。
1 つ目は、id が <tt class="docutils literal"><span class="pre">brief</span></tt> で、指定されたフォーマット文字列をもつ、標準 <a class="reference internal" href="logging.html#logging.Formatter" title="logging.Formatter"><tt class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></tt></a> インスタンスです。
2 つ目は、id が <tt class="docutils literal"><span class="pre">default</span></tt> で、長いフォーマットを持ち、時間フォーマットも定義していて、結果はその 2 つのフォーマット文字列で初期化された
<a class="reference internal" href="logging.html#logging.Formatter" title="logging.Formatter"><tt class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></tt></a> になります。Python ソース形式で見ると、
<tt class="docutils literal"><span class="pre">brief</span></tt> と <tt class="docutils literal"><span class="pre">default</span></tt> フォーマッタは、それぞれ設定の部分辞書:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&#39;format&#39;</span> <span class="p">:</span> <span class="s">&#39;</span><span class="si">%(message)s</span><span class="s">&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>と:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&#39;format&#39;</span> <span class="p">:</span> <span class="s">&#39;</span><span class="si">%(asctime)s</span><span class="s"> </span><span class="si">%(levelname)-8s</span><span class="s"> </span><span class="si">%(name)-15s</span><span class="s"> </span><span class="si">%(message)s</span><span class="s">&#39;</span><span class="p">,</span>
  <span class="s">&#39;datefmt&#39;</span> <span class="p">:</span> <span class="s">&#39;%Y-%m-</span><span class="si">%d</span><span class="s"> %H:%M:%S&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>を持ち、これらの辞書が特殊キー <tt class="docutils literal"><span class="pre">'()'</span></tt> を持たないので、インスタンス化はコンテキストから推測され、結果として標準の <a class="reference internal" href="logging.html#logging.Formatter" title="logging.Formatter"><tt class="xref py py-class docutils literal"><span class="pre">logging.Formatter</span></tt></a>
インスタンスが生成されます。id が <tt class="docutils literal"><span class="pre">custom</span></tt> である、3 つ目のフォーマッタの設定をする部分辞書は:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&#39;()&#39;</span> <span class="p">:</span> <span class="s">&#39;my.package.customFormatterFactory&#39;</span><span class="p">,</span>
  <span class="s">&#39;bar&#39;</span> <span class="p">:</span> <span class="s">&#39;baz&#39;</span><span class="p">,</span>
  <span class="s">&#39;spam&#39;</span> <span class="p">:</span> <span class="mf">99.9</span><span class="p">,</span>
  <span class="s">&#39;answer&#39;</span> <span class="p">:</span> <span class="mi">42</span>
<span class="p">}</span>
</pre></div>
</div>
<p>で、ユーザ定義のインスタンス化が望まれることを示す特殊キー <tt class="docutils literal"><span class="pre">'()'</span></tt> を含みます。この場合、指定された呼び出し可能ファクトリオブジェクトが使われます。これが実際の呼び出し可能オブジェクトであれば、それが直接使われます -
そうではなく、(この例でのように) 文字列を指定したなら、実際の呼び出し可能オブジェクトは、通常のインポート機構を使って検索されます。その呼び出し可能オブジェクトは、環境設定の部分辞書の、 <strong>残りの</strong> 要素をキーワード引数として呼ばれます。上記の例では、id が <tt class="docutils literal"><span class="pre">custom</span></tt> のフォーマッタは、以下の呼び出しによって返されるものとみなされます:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">my</span><span class="o">.</span><span class="n">package</span><span class="o">.</span><span class="n">customFormatterFactory</span><span class="p">(</span><span class="n">bar</span><span class="o">=</span><span class="s">&#39;baz&#39;</span><span class="p">,</span> <span class="n">spam</span><span class="o">=</span><span class="mf">99.9</span><span class="p">,</span> <span class="n">answer</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
<p>キー <tt class="docutils literal"><span class="pre">'()'</span></tt> が特殊キーとして使われるのは、キーワードパラメタ名として不正で、呼び出しに使われるキーワード引数と衝突し得ないからです。
<tt class="docutils literal"><span class="pre">'()'</span></tt> はまた、対応する値が呼び出し可能オブジェクトであると覚えやすくします。</p>
</div>
<div class="section" id="logging-config-dict-externalobj">
<span id="id7"></span><h3>15.8.2.5. 外部オブジェクトへのアクセス<a class="headerlink" href="#logging-config-dict-externalobj" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>環境設定が、例えば <tt class="docutils literal"><span class="pre">sys.stderr</span></tt> のような、設定の外部のオブジェクトへの参照を必要とすることがあります。設定辞書が Python コードで構成されていれば話は簡単ですが、これがテキストファイル (JSON, YAML 等) を通して提供されていると問題となります。テキストファイルでは、 <tt class="docutils literal"><span class="pre">sys.stderr</span></tt> をリテラル文字列 <tt class="docutils literal"><span class="pre">'sys.stderr'</span></tt> と区別する標準の方法がありません。この区別を容易にするため、環境設定システムは、文字列中の特定の特殊接頭辞を見つけ、それらを特殊に扱います。例えば、リテラル文字列 <tt class="docutils literal"><span class="pre">'ext://sys.stderr'</span></tt> が設定中の値として与えられたら、この <tt class="docutils literal"><span class="pre">ext://</span></tt> は剥ぎ取られ、この値の残りが普通のインポート機構で処理されます。</p>
<p>このような接頭辞の処理は、プロトコルの処理と同じようになされます。どちらの機構も、正規表現 <tt class="docutils literal"><span class="pre">^(?P&lt;prefix&gt;[a-z]+)://(?P&lt;suffix&gt;.*)$</span></tt> にマッチする接頭辞を検索し、それによって <tt class="docutils literal"><span class="pre">prefix</span></tt> が認識されたなら、接頭辞に応じたやり方で <tt class="docutils literal"><span class="pre">suffix</span></tt> が処理され、その処理の結果によって文字列値が置き換えられます。接頭辞が認識されなければ、その文字列値はそのまま残されます。</p>
</div>
<div class="section" id="logging-config-dict-internalobj">
<span id="id8"></span><h3>15.8.2.6. 内部オブジェクトへのアクセス<a class="headerlink" href="#logging-config-dict-internalobj" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>外部オブジェクトと同様、環境設定内部のオブジェクトへのアクセスを必要とすることもあります。これは、その各オブジェクトを司る環境設定システムによって暗黙に行われます。例えば、ロガーやハンドラの <tt class="docutils literal"><span class="pre">level</span></tt> に対する文字列値 <tt class="docutils literal"><span class="pre">'DEBUG'</span></tt> は、自動的に値 <tt class="docutils literal"><span class="pre">logging.DEBUG</span></tt> に変換されますし、
<tt class="docutils literal"><span class="pre">handlers</span></tt>, <tt class="docutils literal"><span class="pre">filters</span></tt> および <tt class="docutils literal"><span class="pre">formatter</span></tt> の項目は、オブジェクト id を取って、適切な送信先オブジェクトを決定します。</p>
<p>しかし、ユーザ定義モジュールには、 <a class="reference internal" href="logging.html#module-logging" title="logging: アプリケーションのための、柔軟なエラーロギングシステム"><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a> モジュールには分からないような、より一般的な機構が必要です。例えば、 <a class="reference internal" href="logging.handlers.html#logging.handlers.MemoryHandler" title="logging.handlers.MemoryHandler"><tt class="xref py py-class docutils literal"><span class="pre">logging.handlers.MemoryHandler</span></tt></a> があって、委譲する先の別のハンドラである <tt class="docutils literal"><span class="pre">target</span></tt> 引数を取るとします。システムはこのクラスをすでに知っていますから、設定中で、与えられた <tt class="docutils literal"><span class="pre">target</span></tt> は関連するターゲットハンドラのオブジェクト id でさえあればよく、システムはその id からハンドラを決定します。しかし、ユーザが <tt class="docutils literal"><span class="pre">my.package.MyHandler</span></tt> を定義して、それが <tt class="docutils literal"><span class="pre">alternate</span></tt>
ハンドラを持つなら、設定システムは <tt class="docutils literal"><span class="pre">alternate</span></tt> がハンドラを参照していることを知りません。これを知らせるのに、一般的な解析システムで、ユーザはこのように指定できます:</p>
<div class="highlight-python"><pre>handlers:
  file:
    # configuration of file handler goes here

  custom:
    (): my.package.MyHandler
    alternate: cfg://handlers.file</pre>
</div>
<p>リテラル文字列 <tt class="docutils literal"><span class="pre">'cfg://handlers.file'</span></tt> は、 <tt class="docutils literal"><span class="pre">ext://</span></tt> 接頭辞が付いた文字列と同じように分析されますが、インポート名前空間ではなく、環境設定自体が検索されます。この機構は <tt class="docutils literal"><span class="pre">str.format</span></tt> でできるのと同じようにドットやインデクスのアクセスができます。従って、環境設定において以下のコード片が与えられれば:</p>
<div class="highlight-python"><pre>handlers:
  email:
    class: logging.handlers.SMTPHandler
    mailhost: localhost
    fromaddr: my_app@domain.tld
    toaddrs:
      - support_team@domain.tld
      - dev_team@domain.tld
    subject: Houston, we have a problem.</pre>
</div>
<p>文字列 <tt class="docutils literal"><span class="pre">'cfg://handlers'</span></tt> は、キー <tt class="docutils literal"><span class="pre">handlers</span></tt> をもつ辞書であると分析され、文字列 <tt class="docutils literal"><span class="pre">'cfg://handlers.email'</span></tt> は、 <tt class="docutils literal"><span class="pre">handlers</span></tt> 辞書内の、
<tt class="docutils literal"><span class="pre">email</span></tt> キーをもつ辞書であると分析されます。文字列
<tt class="docutils literal"><span class="pre">'cfg://handlers.email.toaddrs[1]</span></tt> は、 <tt class="docutils literal"><span class="pre">'dev_team&#64;domain.tld'</span></tt> と分析され、 <tt class="docutils literal"><span class="pre">'cfg://handlers.email.toaddrs[0]'</span></tt> は値
<tt class="docutils literal"><span class="pre">'support_team&#64;domain.tld'</span></tt> と分析されます。 <tt class="docutils literal"><span class="pre">subject</span></tt> の値には、
<tt class="docutils literal"><span class="pre">'cfg://handlers.email.subject'</span></tt> または等価な
<tt class="docutils literal"><span class="pre">'cfg://handlers.email[subject]'</span></tt> でアクセスできます。後者が必要なのは、キーがスペースや非アルファベット文字を含むときのみです。インデクス値が十進数時のみで成り立っているなら、まず対応する整数値を使ってアクセスが試みられ、必要なら文字列値で代替します。</p>
<p>文字列 <tt class="docutils literal"><span class="pre">cfg://handlers.myhandler.mykey.123</span></tt> が与えられると、これは
<tt class="docutils literal"><span class="pre">config_dict['handlers']['myhandler']['mykey']['123']</span></tt> と分析されます。文字列が <tt class="docutils literal"><span class="pre">cfg://handlers.myhandler.mykey[123]</span></tt> と指定されたら、システムは <tt class="docutils literal"><span class="pre">config_dict['handlers']['myhandler']['mykey'][123]</span></tt> から値を引き出そうとし、失敗したら
<tt class="docutils literal"><span class="pre">config_dict['handlers']['myhandler']['mykey']['123']</span></tt> で代替します。</p>
</div>
</div>
<div class="section" id="logging-config-fileformat">
<span id="id9"></span><h2>15.8.3. 環境設定ファイルの書式<a class="headerlink" href="#logging-config-fileformat" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference internal" href="#logging.config.fileConfig" title="logging.config.fileConfig"><tt class="xref py py-func docutils literal"><span class="pre">fileConfig()</span></tt></a> が解釈できる環境設定ファイルの形式は、 <a class="reference internal" href="configparser.html#module-ConfigParser" title="ConfigParser: Configuration file parser."><tt class="xref py py-mod docutils literal"><span class="pre">ConfigParser</span></tt></a> の機能に基づいています。ファイルには、 <tt class="docutils literal"><span class="pre">[loggers]</span></tt>, <tt class="docutils literal"><span class="pre">[handlers]</span></tt>, <tt class="docutils literal"><span class="pre">[formatters]</span></tt> といったセクションが入っていなければならず、各セクションではファイル中で定義されている各タイプのエンティティを名前で指定しています。こうしたエンティティの各々について、そのエンティティをどう設定するかを示した個別のセクションがあります。すなわち、 <tt class="docutils literal"><span class="pre">log01</span></tt> という名前の <tt class="docutils literal"><span class="pre">[loggers]</span></tt> セクションにあるロガーに対しては、対応する詳細設定がセクション <tt class="docutils literal"><span class="pre">[logger_log01]</span></tt> に収められています。同様に、 <tt class="docutils literal"><span class="pre">hand01</span></tt> という名前の <tt class="docutils literal"><span class="pre">[handlers]</span></tt> セクションにあるハンドラは
<tt class="docutils literal"><span class="pre">[handler_hand01]</span></tt> と呼ばれるセクションに設定をもつことになり、
<tt class="docutils literal"><span class="pre">[formatters]</span></tt>  セクションにある <tt class="docutils literal"><span class="pre">form01</span></tt> は <tt class="docutils literal"><span class="pre">[formatter_form01]</span></tt> というセクションで設定が指定されています。ルートロガーの設定は <tt class="docutils literal"><span class="pre">[logger_root]</span></tt> と呼ばれるセクションで指定されていなければなりません。</p>
<p>ファイルにおけるこれらのセクションの例を以下に示します:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">loggers</span><span class="p">]</span>
<span class="n">keys</span><span class="o">=</span><span class="n">root</span><span class="p">,</span><span class="n">log02</span><span class="p">,</span><span class="n">log03</span><span class="p">,</span><span class="n">log04</span><span class="p">,</span><span class="n">log05</span><span class="p">,</span><span class="n">log06</span><span class="p">,</span><span class="n">log07</span>

<span class="p">[</span><span class="n">handlers</span><span class="p">]</span>
<span class="n">keys</span><span class="o">=</span><span class="n">hand01</span><span class="p">,</span><span class="n">hand02</span><span class="p">,</span><span class="n">hand03</span><span class="p">,</span><span class="n">hand04</span><span class="p">,</span><span class="n">hand05</span><span class="p">,</span><span class="n">hand06</span><span class="p">,</span><span class="n">hand07</span><span class="p">,</span><span class="n">hand08</span><span class="p">,</span><span class="n">hand09</span>

<span class="p">[</span><span class="n">formatters</span><span class="p">]</span>
<span class="n">keys</span><span class="o">=</span><span class="n">form01</span><span class="p">,</span><span class="n">form02</span><span class="p">,</span><span class="n">form03</span><span class="p">,</span><span class="n">form04</span><span class="p">,</span><span class="n">form05</span><span class="p">,</span><span class="n">form06</span><span class="p">,</span><span class="n">form07</span><span class="p">,</span><span class="n">form08</span><span class="p">,</span><span class="n">form09</span>
</pre></div>
</div>
<p>ルートロガーでは、レベルとハンドラのリストを指定しなければなりません。ルートロガーのセクションの例を以下に示します:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">logger_root</span><span class="p">]</span>
<span class="n">level</span><span class="o">=</span><span class="n">NOTSET</span>
<span class="n">handlers</span><span class="o">=</span><span class="n">hand01</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">level</span></tt> エントリは <tt class="docutils literal"><span class="pre">DEBUG,</span> <span class="pre">INFO,</span> <span class="pre">WARNING,</span> <span class="pre">ERROR,</span> <span class="pre">CRITICAL</span></tt> のうちの一つか、 <tt class="docutils literal"><span class="pre">NOTSET</span></tt> になります。ルートロガーの場合にのみ、 <tt class="docutils literal"><span class="pre">NOTSET</span></tt> はすべてのメッセージがログ記録されることを意味します。レベル値は <tt class="docutils literal"><span class="pre">logging</span></tt> パッケージの名前空間のコンテキストにおいて <a class="reference internal" href="functions.html#eval" title="eval"><tt class="xref py py-func docutils literal"><span class="pre">eval()</span></tt></a> されます。</p>
<p><tt class="docutils literal"><span class="pre">handlers</span></tt> エントリはコンマで区切られたハンドラ名からなるリストで、 <tt class="docutils literal"><span class="pre">[handlers]</span></tt> セクションになくてはなりません。また、これらの各ハンドラの名前に対応するセクションが設定ファイルに存在しなければなりません。</p>
<p>ルートロガー以外のロガーでは、いくつか追加の情報が必要になります。これは以下の例のように表されます:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="n">logger_parser</span><span class="p">]</span>
<span class="n">level</span><span class="o">=</span><span class="n">DEBUG</span>
<span class="n">handlers</span><span class="o">=</span><span class="n">hand01</span>
<span class="n">propagate</span><span class="o">=</span><span class="mi">1</span>
<span class="n">qualname</span><span class="o">=</span><span class="n">compiler</span><span class="o">.</span><span class="n">parser</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">level</span></tt> および <tt class="docutils literal"><span class="pre">handlers</span></tt> エントリはルートロガーのエントリと同様に解釈されますが、非ルートロガーのレベルが <tt class="docutils literal"><span class="pre">NOTSET</span></tt> に指定された場合、ロギングシステムはロガー階層のより上位のロガーにロガーの実効レベルを問い合わせるところが違います。
<tt class="docutils literal"><span class="pre">propagate</span></tt> エントリは、メッセージをロガー階層におけるこのロガーの上位のハンドラに伝播させることを示す 1 に設定されるか、メッセージを階層の上位に伝播 <strong>しない</strong> ことを示す 0 に設定されます。
<tt class="docutils literal"><span class="pre">qualname</span></tt> エントリはロガーのチャネル名を階層的に表したもの、すなわちアプリケーションがこのロガーを取得する際に使う名前になります。</p>
<p>ハンドラの環境設定を指定しているセクションは以下の例のようになります:</p>
<div class="highlight-python"><pre>[handler_hand01]
class=StreamHandler
level=NOTSET
formatter=form01
args=(sys.stdout,)</pre>
</div>
<p><tt class="docutils literal"><span class="pre">class</span></tt> エントリはハンドラのクラス (<tt class="docutils literal"><span class="pre">logging</span></tt> パッケージの名前空間において <a class="reference internal" href="functions.html#eval" title="eval"><tt class="xref py py-func docutils literal"><span class="pre">eval()</span></tt></a> で決定されます) を示します。
<tt class="docutils literal"><span class="pre">level</span></tt> はロガーの場合と同じように解釈され、 <tt class="docutils literal"><span class="pre">NOTSET</span></tt>  は &#8220;すべてを記録する (log everything)&#8221; と解釈されます。</p>
<p class="versionchanged">
<span class="versionmodified">バージョン 2.6 で変更: </span>ハンドラクラスのドット区切りモジュールおよびクラス名としての解決のサポートが追加された。</p>
<p><tt class="docutils literal"><span class="pre">formatter</span></tt> エントリはこのハンドラのフォーマッタに対するキー名を表します。空文字列の場合、デフォルトのフォーマッタ (<tt class="docutils literal"><span class="pre">logging._defaultFormatter</span></tt>) が使われます。名前が指定されている場合、その名前は <tt class="docutils literal"><span class="pre">[formatters]</span></tt> セクションになくてはならず、対応するセクションが設定ファイル中になければなりません。</p>
<p><tt class="docutils literal"><span class="pre">args</span></tt> エントリは、 <tt class="docutils literal"><span class="pre">logging</span></tt> パッケージの名前空間のコンテキストで <a class="reference internal" href="functions.html#eval" title="eval"><tt class="xref py py-func docutils literal"><span class="pre">eval()</span></tt></a> される際、ハンドラクラスのコンストラクタに対する引数からなるリストになります。典型的なエントリがどうやって作成されるかについては、対応するハンドラのコンストラクタか、以下の例を参照してください:</p>
<div class="highlight-python"><pre>[handler_hand02]
class=FileHandler
level=DEBUG
formatter=form02
args=('python.log', 'w')

[handler_hand03]
class=handlers.SocketHandler
level=INFO
formatter=form03
args=('localhost', handlers.DEFAULT_TCP_LOGGING_PORT)

[handler_hand04]
class=handlers.DatagramHandler
level=WARN
formatter=form04
args=('localhost', handlers.DEFAULT_UDP_LOGGING_PORT)

[handler_hand05]
class=handlers.SysLogHandler
level=ERROR
formatter=form05
args=(('localhost', handlers.SYSLOG_UDP_PORT), handlers.SysLogHandler.LOG_USER)

[handler_hand06]
class=handlers.NTEventLogHandler
level=CRITICAL
formatter=form06
args=('Python Application', '', 'Application')

[handler_hand07]
class=handlers.SMTPHandler
level=WARN
formatter=form07
args=('localhost', 'from@abc', ['user1@abc', 'user2@xyz'], 'Logger Subject')

[handler_hand08]
class=handlers.MemoryHandler
level=NOTSET
formatter=form08
target=
args=(10, ERROR)

[handler_hand09]
class=handlers.HTTPHandler
level=NOTSET
formatter=form09
args=('localhost:9022', '/log', 'GET')</pre>
</div>
<p>フォーマッタの環境設定を指定しているセクションは以下のような形式です:</p>
<div class="highlight-python"><pre>[formatter_form01]
format=F1 %(asctime)s %(levelname)s %(message)s
datefmt=
class=logging.Formatter</pre>
</div>
<p><tt class="docutils literal"><span class="pre">format</span></tt> エントリは全体を書式化する文字列で、 <tt class="docutils literal"><span class="pre">datefmt</span></tt> エントリは <tt class="xref py py-func docutils literal"><span class="pre">strftime()</span></tt> 互換の日付/時刻書式化文字列です。空文字列の場合、パッケージによって ISO8601 形式の日付/時刻に置き換えられ、日付書式化文字列 <tt class="docutils literal"><span class="pre">&quot;%Y-%m-%d</span> <span class="pre">%H:%M:%S&quot;</span></tt> を指定した場合とほとんど同じになります。
ISO8601 形式ではミリ秒も指定しており、上の書式化文字列の結果にカンマで区切って追加されます。
ISO8601 形式の時刻の例は <tt class="docutils literal"><span class="pre">2003-01-23</span> <span class="pre">00:29:50,411</span></tt> です。</p>
<p><tt class="docutils literal"><span class="pre">class</span></tt> エントリはオプションです。
<tt class="docutils literal"><span class="pre">class</span></tt> はフォーマッタのクラス名 (ドット区切りのモジュールとクラス名として) を示します。このオプションは <tt class="xref py py-class docutils literal"><span class="pre">Formatter</span></tt> のサブクラスをインスタンス化するのに有用です。
<tt class="xref py py-class docutils literal"><span class="pre">Formatter</span></tt> のサブクラスは例外トレースバックを展開された形式または圧縮された形式で表現することができます。</p>
<div class="admonition- admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt>モジュール <a class="reference internal" href="logging.html#module-logging" title="logging: アプリケーションのための、柔軟なエラーロギングシステム"><tt class="xref py py-mod docutils literal"><span class="pre">logging</span></tt></a></dt>
<dd>logging モジュールの API リファレンス。</dd>
<dt>Module <a class="reference internal" href="logging.handlers.html#module-logging.handlers" title="logging.handlers: logging モジュールのためのハンドラ"><tt class="xref py py-mod docutils literal"><span class="pre">logging.handlers</span></tt></a></dt>
<dd>logging モジュールに含まれる便利なハンドラ。</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="logging.handlers.html" title="15.9. logging.handlers — ロギングハンドラ"
             >次へ</a> |</li>
        <li class="right" >
          <a href="logging.html" title="15.7. logging — Python 用ロギング機能"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="../index.html">Python 2.7ja1 documentation</a> &raquo;</li>

          <li><a href="index.html" >Python 標準ライブラリ</a> &raquo;</li>
          <li><a href="allos.html" >15. 汎用オペレーティングシステムサービス</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; <a href="../copyright.html">Copyright</a> 1990-2011, Python Software Foundation.
      最終更新: 2011-12-26
      このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/02cb752c6a9e で生成しました。
    </div>
  </body>
</html>